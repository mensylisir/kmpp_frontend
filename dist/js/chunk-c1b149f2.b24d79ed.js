(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1b149f2"],{"00fb":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("complex-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{selects:e.nsSelection,data:e.data},on:{"update:selects":function(t){e.nsSelection=t}},scopedSlots:e._u([{key:"header",fn:function(){return[a("el-button-group",[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.create()}}},[e._v(e._s(e.$t("commons.button.create")))]),a("el-button",{attrs:{size:"small",disabled:e.nsSelection.length<1},on:{click:function(t){return e.onDelete()}}},[e._v(e._s(e.$t("commons.button.delete")))])],1)]},proxy:!0}])},[a("el-table-column",{attrs:{type:"selection",selectable:e.isInSystemSpace,fix:""}}),a("el-table-column",{attrs:{label:e.$t("commons.table.name"),"min-width":"100",prop:"metadata.name",fix:""}}),a("el-table-column",{attrs:{label:e.$t("commons.table.status"),"min-width":"100",prop:"status.phase",fix:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["Terminating"!==n.status.phase?a("div",[a("span"),e._v(e._s(n.status.phase)+" ")]):e._e(),"Terminating"===n.status.phase?a("div",[a("i",{staticClass:"el-icon-loading"}),e._v("       "),a("span",[e._v(e._s(e.$t("commons.status.terminating"))+" ")])]):e._e()]}}])}),a("el-table-column",{attrs:{label:e.$t("commons.table.create_time")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("datetimeFormat")(a.metadata.creationTimestamp))+" ")]}}])}),a("fu-table-operations",{attrs:{buttons:e.buttons,label:e.$t("commons.table.action"),fix:""}})],1),a("el-dialog",{attrs:{title:e.$t("commons.button.create"),width:"30%","close-on-click-modal":!1,visible:e.dialogCreateVisible},on:{"update:visible":function(t){e.dialogCreateVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left","label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("commons.table.name"),prop:"metadata.name",rules:e.nameRules}},[a("el-input",{staticStyle:{width:"80%"},attrs:{clearable:""},model:{value:e.form.metadata.name,callback:function(t){e.$set(e.form.metadata,"name",t)},expression:"form.metadata.name"}}),a("div",[a("span",{staticClass:"input-help"},[e._v(e._s(e.$t("commons.validate.common_name_help")))])])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogCreateVisible=!1}}},[e._v(e._s(e.$t("commons.button.cancel")))]),a("el-button",{attrs:{type:"primary",disabled:0===e.form.metadata.name.length||e.submitLoading},on:{click:function(t){return e.submitCreate()}}},[e._v(e._s(e.$t("commons.button.ok")))])],1)],1)],1)},s=[],o=a("30d5"),c=(a("2769"),a("ecf1"),a("f5bd"),a("b1fa"),a("2e6f"),a("af21"),a("86ca")),i=a("0600"),l=a("5671"),r=a("0792"),u={name:"ClusterNamespace",components:{ComplexTable:c["a"]},data:function(){var e=this;return{loading:!1,submitLoading:!1,buttons:[{label:this.$t("commons.button.delete"),icon:"el-icon-delete",click:function(t){e.onDelete(t)},disabled:function(t){return!e.isInSystemSpace(t)}}],form:{apiVersion:"v1",kind:"Namespace",metadata:{name:""}},nameRules:[r["a"].CommonNameRule],nsSelection:[],toolList:[],dialogCreateVisible:!1,clusterName:"",selects:[],data:[],ps:[],timer:{}}},methods:{search:function(){var e=this;this.loading=!0,Object(i["c"])(this.clusterName).then((function(t){e.data=t.items,e.loading=!1})).catch((function(){e.loading=!1}))},create:function(){this.dialogCreateVisible=!0},loadTools:function(){var e=this;Object(l["c"])(this.clusterName).then((function(t){e.toolList=t}))},submitCreate:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;e.submitLoading=!0,Object(i["a"])(e.clusterName,e.form).then((function(){e.$message({type:"success",message:e.$t("commons.msg.create_success")}),e.dialogCreateVisible=!1,e.search(),e.submitLoading=!1})).catch((function(){e.submitLoading=!1,e.dialogCreateVisible=!1}))}))},isInSystemSpace:function(e){var t=["default","kube-public","kube-operator","kube-system","istio-system","kube-node-lease"];return-1===t.indexOf(e.metadata.name)},checkIsEmptyNs:function(e){if(e){var t,a="",n=Object(o["a"])(this.toolList);try{for(n.s();!(t=n.n()).done;){var s=t.value;s.vars["namespace"]===e.metadata.name&&"Waiting"!==s.status&&(a+=s.name+",")}}catch(d){n.e(d)}finally{n.f()}e.toolDetails=a}else{var c,i=Object(o["a"])(this.nsSelection);try{for(i.s();!(c=i.n()).done;){var l,r=c.value,u="",m=Object(o["a"])(this.toolList);try{for(m.s();!(l=m.n()).done;){var f=l.value;f.vars["namespace"]===r.metadata.name&&"Waiting"!==f.status&&(u+=f.name+",")}}catch(d){m.e(d)}finally{m.f()}r.toolDetails=u}}catch(d){i.e(d)}finally{i.f()}}},onDelete:function(e){var t=this;this.checkIsEmptyNs(e),this.$confirm(this.$t("commons.confirm_message.delete"),this.$t("commons.message_box.prompt"),{confirmButtonText:this.$t("commons.button.confirm"),cancelButtonText:this.$t("commons.button.cancel"),type:"warning"}).then((function(){if(t.ps=[],e)e.toolDetails?t.$message({type:"info",message:e.metadata.name+t.$t("cluster.detail.namespace.before_delete")+e.toolDetails}):t.ps.push(Object(i["b"])(t.clusterName,e.metadata.name));else{var a,n=Object(o["a"])(t.nsSelection);try{for(n.s();!(a=n.n()).done;){var s=a.value;s.toolDetails?t.$message({type:"info",message:s.metadata.name+t.$t("cluster.detail.namespace.before_delete")+s.toolDetails}):t.ps.push(Object(i["b"])(t.clusterName,s.metadata.name))}}catch(c){n.e(c)}finally{n.f()}}0!==t.ps.length&&Promise.all(t.ps).then((function(){t.search(),t.$message({type:"success",message:t.$t("commons.msg.op_success")})})).catch((function(){t.search()}))}))},polling:function(){var e=this;this.timer=setInterval((function(){var t,a=!1,n=["Terminating"],s=Object(o["a"])(e.data);try{for(s.s();!(t=s.n()).done;){var c=t.value;if(-1!==n.indexOf(c.status.phase)){a=!0;break}}}catch(l){s.e(l)}finally{s.f()}a&&Object(i["c"])(e.clusterName).then((function(t){e.data=t.items}))}),1e4)}},created:function(){this.clusterName=this.$route.params.name,this.search(),this.loadTools(),this.polling()},destroyed:function(){clearInterval(this.timer)}},m=u,f=a("5d22"),d=Object(f["a"])(m,n,s,!1,null,"6922c841",null);t["default"]=d.exports},"0600":function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return r}));a("2769"),a("0756");var n=a("ff66"),s="/proxy/kubernetes/{cluster_name}/{resource_url}",o="api/v1/namespaces",c="api/v1/namespaces/{namespace}";function i(e){var t=s.replace("{cluster_name}",e).replace("{resource_url}",o);return Object(n["c"])(t)}function l(e,t){var a=s.replace("{cluster_name}",e).replace("{resource_url}",o);return Object(n["e"])(a,t)}function r(e,t){var a=s.replace("{cluster_name}",e).replace("{resource_url}",c).replace("{namespace}",t);return Object(n["b"])(a)}},5671:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return l}));var n=a("ff66"),s="/api/v1/clusters/tool";function o(e){return Object(n["c"])("".concat(s,"/").concat(e))}function c(e,t){return Object(n["e"])("".concat(s,"/enable/").concat(e),t)}function i(e,t){return Object(n["e"])("".concat(s,"/disable/").concat(e),t)}function l(e,t){return Object(n["e"])("".concat(s,"/upgrade/").concat(e),t)}}}]);
//# sourceMappingURL=chunk-c1b149f2.b24d79ed.js.map