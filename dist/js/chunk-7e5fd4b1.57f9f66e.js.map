{"version":3,"sources":["webpack:///./src/business/automatic/zones/edit/index.vue?ddcf","webpack:///src/business/automatic/zones/edit/index.vue","webpack:///./src/business/automatic/zones/edit/index.vue?e7ce","webpack:///./src/business/automatic/zones/edit/index.vue","webpack:///./src/api/ip-pool.js","webpack:///./src/api/zone.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","$t","name","staticClass","directives","rawName","value","expression","ref","form","rules","model","callback","$$v","$set","provider","cloudVars","_v","_s","staticStyle","oldDatastores","newDatastores","_l","item","index","key","_e","on","$event","changeIpPool","onCancel","onSubmit","currentPool","subnet","ips","length","gateway","dns1","dns2","ipUsed","staticRenderFns","components","props","data","ipPoolName","datastoreType","datastore","loading","ipPools","cloudDatastores","cloudZoneRequest","regionName","methods","$router","push","$refs","formName","validate","valid","type","message","created","component","ipPoolUrl","listAllIpPools","get","deleteIpPoolBy","del","createIpPool","post","searchIpPool","currentPage","pageSize","conditions","deleteIpBy","ip","createIp","syncIp","patch","searchIp","updateIp","zoneUrl","deleteZoneBy","searchZone","page","size","condition","listCloudZones","listDatastores","listTemplates","createZone","listByRegion","getZone","updateZone"],"mappings":"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","file":"js/chunk-7e5fd4b1.57f9f66e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('layout-content',{attrs:{\"header\":_vm.$t('commons.button.edit'),\"back-to\":{ name: 'ZoneList' }}},[_c('el-row',[_c('el-col',{attrs:{\"span\":4}},[_c('br')]),_c('el-col',{attrs:{\"span\":10}},[_c('div',{staticClass:\"grid-content bg-purple-light\"},[_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"form\",attrs:{\"label-width\":\"200px\",\"model\":_vm.form,\"rules\":_vm.rules,\"label-position\":\"left\"}},[_c('el-form-item',{attrs:{\"label\":_vm.$t('commons.table.name'),\"prop\":\"name\"}},[_c('el-input',{attrs:{\"disabled\":\"\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),(_vm.form.provider === 'vSphere' || _vm.form.provider === 'FusionCompute')?_c('div',[_c('el-form-item',{attrs:{\"label\":_vm.$t('automatic.zone.datastore_type'),\"prop\":\"cloudVars.datastoreType\"}},[_c('el-radio-group',{model:{value:(_vm.form.cloudVars.datastoreType),callback:function ($$v) {_vm.$set(_vm.form.cloudVars, \"datastoreType\", $$v)},expression:\"form.cloudVars.datastoreType\"}},[_c('el-radio',{attrs:{\"label\":\"value\"}},[_vm._v(_vm._s(_vm.$t(\"automatic.zone.value\")))]),_c('el-radio',{attrs:{\"label\":\"usage\"}},[_vm._v(_vm._s(_vm.$t(\"automatic.zone.usage\")))])],1)],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('automatic.zone.old_datastores'),\"prop\":\"oldDatastores\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"multiple\":\"\",\"filterable\":\"\",\"reserve-keyword\":\"\",\"disabled\":\"\"},model:{value:(_vm.oldDatastores),callback:function ($$v) {_vm.oldDatastores=$$v},expression:\"oldDatastores\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('automatic.zone.new_datastores'),\"prop\":\"chooseDatastores\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"multiple\":\"\",\"filterable\":\"\",\"reserve-keyword\":\"\"},model:{value:(_vm.newDatastores),callback:function ($$v) {_vm.newDatastores=$$v},expression:\"newDatastores\"}},_vm._l((_vm.cloudDatastores),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.name,\"value\":item.name}})}),1)],1)],1):_vm._e(),_c('el-form-item',{attrs:{\"label\":_vm.$t('automatic.ip_pool.name'),\"prop\":\"ipPoolName\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"filterable\":\"\",\"reserve-keyword\":\"\"},on:{\"change\":function($event){return _vm.changeIpPool()}},model:{value:(_vm.form.ipPoolName),callback:function ($$v) {_vm.$set(_vm.form, \"ipPoolName\", $$v)},expression:\"form.ipPoolName\"}},_vm._l((_vm.ipPools),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.name,\"value\":item.name}})}),1)],1),_c('el-form-item',[_c('div',{staticStyle:{\"float\":\"right\"}},[_c('el-button',{on:{\"click\":function($event){return _vm.onCancel()}}},[_vm._v(_vm._s(_vm.$t(\"commons.button.cancel\")))]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.onSubmit('form')}}},[_vm._v(_vm._s(_vm.$t(\"commons.button.submit\")))])],1)])],1),_c('h3',[_vm._v(_vm._s(_vm.$t(\"automatic.ip_pool.name\")))]),(_vm.currentPool)?_c('table',{staticClass:\"el-table\"},[_c('tbody',[_c('tr',[_c('th',[_vm._v(_vm._s(_vm.$t(\"commons.table.name\")))]),_c('td',[_vm._v(_vm._s(_vm.currentPool.name))])]),_c('tr',[_c('th',[_vm._v(_vm._s(_vm.$t(\"automatic.ip_pool.subnet\")))]),_c('td',[_vm._v(_vm._s(_vm.currentPool.subnet))])]),_c('tr',[_c('th',[_vm._v(_vm._s(_vm.$t(\"automatic.ip_pool.gateway\")))]),(_vm.currentPool.ips.length >0 )?_c('td',[_vm._v(_vm._s(_vm.currentPool.ips[0].gateway))]):_vm._e()]),_c('tr',[_c('th',[_vm._v(_vm._s(_vm.$t(\"automatic.ip_pool.dns1\")))]),(_vm.currentPool.ips.length >0 )?_c('td',[_vm._v(_vm._s(_vm.currentPool.ips[0].dns1))]):_vm._e()]),_c('tr',[_c('th',[_vm._v(_vm._s(_vm.$t(\"automatic.ip_pool.dns2\")))]),(_vm.currentPool.ips.length >0 )?_c('td',[_vm._v(_vm._s(_vm.currentPool.ips[0].dns2))]):_vm._e()]),_c('tr',[_c('th',[_vm._v(_vm._s(_vm.$t(\"automatic.ip_pool.ip_usage\")))]),_c('td',[_vm._v(_vm._s(_vm.currentPool.ipUsed)+\"/\"+_vm._s(_vm.currentPool.ips.length))])])])]):_vm._e()],1)])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <layout-content :header=\"$t('commons.button.edit')\" :back-to=\"{ name: 'ZoneList' }\">\n    <el-row>\n      <el-col :span=\"4\"><br/></el-col>\n      <el-col :span=\"10\">\n        <div class=\"grid-content bg-purple-light\">\n          <el-form ref=\"form\" label-width=\"200px\" :model=\"form\" :rules=\"rules\" v-loading=\"loading\" label-position=\"left\">\n            <el-form-item :label=\"$t('commons.table.name')\" prop=\"name\">\n              <el-input v-model=\"form.name\" disabled></el-input>\n            </el-form-item>\n            <div v-if=\"form.provider === 'vSphere' || form.provider === 'FusionCompute'\">\n              <el-form-item :label=\"$t('automatic.zone.datastore_type')\"\n                            prop=\"cloudVars.datastoreType\">\n                <el-radio-group v-model=\"form.cloudVars.datastoreType\">\n                  <el-radio label=\"value\">{{ $t(\"automatic.zone.value\") }}</el-radio>\n                  <el-radio label=\"usage\">{{ $t(\"automatic.zone.usage\") }}</el-radio>\n                </el-radio-group>\n              </el-form-item>\n              <el-form-item :label=\"$t('automatic.zone.old_datastores')\" prop=\"oldDatastores\">\n                <el-select v-model=\"oldDatastores\"\n                           multiple\n                           filterable style=\"width:100%\"\n                           reserve-keyword\n                           disabled>\n                </el-select>\n              </el-form-item>\n              <el-form-item :label=\"$t('automatic.zone.new_datastores')\" prop=\"chooseDatastores\">\n                <el-select v-model=\"newDatastores\"\n                           multiple\n                           filterable style=\"width:100%\"\n                           reserve-keyword>\n                  <el-option\n                          v-for=\"(item,index) in cloudDatastores\"\n                          :key=\"index\"\n                          :label=\"item.name\"\n                          :value=\"item.name\">\n                  </el-option>\n                </el-select>\n              </el-form-item>\n            </div>\n            <el-form-item :label=\"$t('automatic.ip_pool.name')\" prop=\"ipPoolName\">\n              <el-select v-model=\"form.ipPoolName\" filterable style=\"width:100%\" reserve-keyword @change=\"changeIpPool()\">\n                <el-option\n                        v-for=\"(item,index) in ipPools\"\n                        :key=\"index\"\n                        :label=\"item.name\"\n                        :value=\"item.name\">\n                </el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item>\n              <div style=\"float: right\">\n                <el-button @click=\"onCancel()\">{{ $t(\"commons.button.cancel\") }}</el-button>\n                <el-button type=\"primary\" @click=\"onSubmit('form')\">{{ $t(\"commons.button.submit\") }}</el-button>\n              </div>\n            </el-form-item>\n          </el-form>\n          <h3>{{ $t(\"automatic.ip_pool.name\") }}</h3>\n          <table class=\"el-table\" v-if=\"currentPool\">\n            <tbody>\n            <tr>\n              <th>{{ $t(\"commons.table.name\") }}</th>\n              <td>{{ currentPool.name }}</td>\n            </tr>\n            <tr>\n              <th>{{ $t(\"automatic.ip_pool.subnet\") }}</th>\n              <td>{{ currentPool.subnet }}</td>\n            </tr>\n            <tr>\n              <th>{{ $t(\"automatic.ip_pool.gateway\") }}</th>\n              <td v-if=\"currentPool.ips.length >0 \">{{ currentPool.ips[0].gateway }}</td>\n            </tr>\n            <tr>\n              <th>{{ $t(\"automatic.ip_pool.dns1\") }}</th>\n              <td v-if=\"currentPool.ips.length >0 \">{{ currentPool.ips[0].dns1 }}</td>\n            </tr>\n            <tr>\n              <th>{{ $t(\"automatic.ip_pool.dns2\") }}</th>\n              <td v-if=\"currentPool.ips.length >0 \">{{ currentPool.ips[0].dns2 }}</td>\n            </tr>\n            <tr>\n              <th>{{ $t(\"automatic.ip_pool.ip_usage\") }}</th>\n              <td>{{ currentPool.ipUsed }}/{{ currentPool.ips.length }}</td>\n            </tr>\n            </tbody>\n          </table>\n        </div>\n      </el-col>\n    </el-row>\n  </layout-content>\n</template>\n\n<script>\nimport LayoutContent from \"@/components/layout/LayoutContent\"\nimport {getZone, listDatastores,updateZone} from \"@/api/zone\"\nimport {listAllIpPools} from \"@/api/ip-pool\"\n\nexport default {\n  name: \"ZoneEdit\",\n  components: { LayoutContent },\n  props: [\"name\"],\n  data () {\n    return {\n      form: {\n        name: \"\",\n        ipPoolName: \"\",\n        cloudVars: {\n          datastoreType: \"\",\n          datastore: \"\"\n        },\n        provider: \"\"\n      },\n      rules: {\n      },\n      loading: false,\n      ipPools: [],\n      cloudDatastores: [],\n      cloudZoneRequest: {\n        regionName: \"\",\n        cloudVars: {}\n      },\n      newDatastores: [],\n      oldDatastores: [],\n      currentPool: {\n        ips: [],\n        ipUsed: 0\n      }\n    }\n  },\n  methods: {\n    onCancel () {\n      this.$router.push({ name: \"ZoneList\" })\n    },\n    changeIpPool () {\n      for (const p of this.ipPools) {\n        if (this.form.ipPoolName === p.name) {\n          this.currentPool = p\n          break\n        }\n      }\n    },\n    onSubmit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (!valid) {\n          return false\n        }\n        if (this.form.provider === 'vSphere' || this.form.provider === 'FusionCompute') {\n          if (this.form.cloudVars['datastore'] instanceof Array) {\n            this.form.cloudVars['datastore'] = this.form.cloudVars['datastore'].concat(this.newDatastores);\n          } else if (this.form.cloudVars['datastore'].length > 0) {\n            this.newDatastores.push(this.form.cloudVars['datastore']);\n            this.form.cloudVars['datastore'] = this.newDatastores;\n          }\n        }\n        this.loading = true\n        updateZone(this.form.name, this.form).then(() => {\n          this.loading = false\n          this.$message({\n            type: \"success\",\n            message: this.$t(\"commons.msg.save_success\")\n          })\n          this.$router.push({ name: \"ZoneList\" })\n        }).finally(() => {\n          this.loading = false\n        })\n      })\n    }\n  },\n  created () {\n    this.loading = true\n    getZone(this.name).then(res => {\n      this.form = res\n      listAllIpPools().then(data => {\n        this.ipPools = data.items\n        this.changeIpPool()\n      })\n      this.oldDatastores = this.form.cloudVars[\"datastore\"]\n      if (this.form.provider === \"vSphere\" || this.form.provider === \"FusionCompute\") {\n        this.cloudZoneRequest.cloudVars = this.form.cloudVars\n        this.cloudZoneRequest.regionName = this.form.regionName\n        listDatastores(this.cloudZoneRequest).then(res => {\n          if (this.form.cloudVars[\"datastore\"] instanceof Array) {\n            const old = this.form.cloudVars[\"datastore\"]\n            for (const n of res) {\n              let exist = false\n              for (const o of old) {\n                if (n.name === o) {\n                  exist = true\n                }\n              }\n              if (!exist) {\n                this.cloudDatastores.push(n)\n              }\n            }\n          } else {\n            //为了兼容旧版本\n            const old = this.form.cloudVars[\"datastore\"]\n            for (const n of res) {\n              if (n.name !== old) {\n                this.cloudDatastores.push(n)\n              }\n            }\n          }\n        })\n      }\n      this.loading = false\n    })\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=2d288ca7&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2d288ca7\",\n  null\n  \n)\n\nexport default component.exports","import {get, del, post, patch} from \"@/plugins/request\"\n\nconst ipPoolUrl = \"/api/v1/ippools\"\n\nexport function listIpPools (page, size) {\n  return get(`${ipPoolUrl}?pageNum=${page}&pageSize=${size}`)\n}\n\nexport function listAllIpPools () {\n  return get(`${ipPoolUrl}`)\n}\n\nexport function deleteIpPoolBy (name) {\n  return del(`${ipPoolUrl}/${name}`)\n}\n\nexport function createIpPool (data) {\n  return post(ipPoolUrl, data)\n}\n\nexport function searchIpPool (currentPage, pageSize, conditions) {\n  return post(`${ipPoolUrl}/search?pageNum=${currentPage}&pageSize=${pageSize}`, conditions)\n\n}\n\nexport function listIps (ipPoolName, page, size) {\n  return get(`ippools/${ipPoolName}/ips?pageNum=${page}&pageSize=${size}`)\n}\n\nexport function deleteIpBy (ipPoolName, ip) {\n  return del(`${ipPoolUrl}/${ipPoolName}/ips/${ip}`)\n}\n\nexport function createIp (ipPoolName, data) {\n  return post(`${ipPoolUrl}/${ipPoolName}/ips`, data)\n}\n\nexport function syncIp (ipPoolName) {\n  return patch(`${ipPoolUrl}/${ipPoolName}/ips/sync`)\n}\n\nexport function searchIp (currentPage, pageSize, ipPoolName, conditions) {\n  return post(`${ipPoolUrl}/${ipPoolName}/ips/search?pageNum=${currentPage}&pageSize=${pageSize}`, conditions)\n}\n\nexport function updateIp (ipPoolName, name, data) {\n  return patch(`${ipPoolUrl}/${ipPoolName}/ips/${name}`,data)\n}\n","import {get, del, post, patch} from \"@/plugins/request\"\n\nconst zoneUrl = \"/api/v1/zones\"\n\nexport function listZones (page, size) {\n  return get(`${zoneUrl}?pageNum=${page}&pageSize=${size}`)\n}\n\nexport function deleteZoneBy (name) {\n  return del(zoneUrl + \"/\" + name)\n}\n\nexport function searchZone (page, size, condition) {\n  return post(`${zoneUrl}/search?pageNum=${page}&pageSize=${size}`, condition)\n}\n\nexport function listCloudZones (data) {\n  return post(`${zoneUrl}/clusters`, data)\n}\n\nexport function listDatastores (data) {\n  return post(`${zoneUrl}/datastores`, data)\n}\n\nexport function listTemplates (data) {\n  return post(`${zoneUrl}/templates`, data)\n}\n\nexport function createZone (data) {\n  return post(`${zoneUrl}`, data)\n}\n\nexport function listAllZones () {\n  return get(`${zoneUrl}`)\n}\n\nexport function listByRegion(regionName) {\n  return get(`${zoneUrl}/list/${regionName}`)\n}\n\nexport function getZone(name) {\n  return get(`${zoneUrl}/${name}`)\n}\n\nexport function updateZone(name,data) {\n  return patch(`${zoneUrl}/${name}`, data)\n}\n"],"sourceRoot":""}