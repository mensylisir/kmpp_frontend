(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c620bb7"],{"174e":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("layout-content",[t("el-row",{staticStyle:{"margin-top":"20px"}},[t("el-col",{attrs:{span:4}},[t("br")]),t("el-col",{attrs:{span:10}},[t("div",{staticClass:"grid-content bg-purple-light"},[t("el-form",{ref:"form",attrs:{"label-position":"left",model:e.form,"label-width":"200px"}},[t("el-form-item",{attrs:{label:e.$t("commons.table.name"),prop:"metadata.name",rules:e.nameRules}},[t("el-input",{attrs:{size:"small"},model:{value:e.form.metadata.name,callback:function(r){e.$set(e.form.metadata,"name",r)},expression:"form.metadata.name"}}),t("div",[t("span",{staticClass:"input-help"},[e._v(e._s(e.$t("commons.validate.common_name_help")))])])],1),t("el-form-item",{attrs:{label:e.$t("cluster.detail.storage.provisioner_short"),required:""}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small","value-key":"name",clearable:""},on:{change:function(r){return e.changeClassType()}},model:{value:e.provisioner,callback:function(r){e.provisioner=r},expression:"provisioner"}},e._l(e.provisioners,(function(r){return t("el-option",{key:r.name,attrs:{disabled:"Running"!==r.status,label:"["+r.type+"]"+r.name,value:r}},[e._v("["+e._s(r.type)+"]"+e._s(r.name))])})),1)],1),"nfs"===e.createType?t("div",[t("el-form-item",{attrs:{label:e.$t("cluster.detail.storage.provisioner_name"),required:""}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.provisioner,callback:function(r){e.$set(e.form,"provisioner",r)},expression:"form.provisioner"}})],1)],1):e._e(),"external-ceph"===e.createType?t("div",[t("el-form-item",{attrs:{label:e.$t("commons.table.name"),required:""}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.provisioner,callback:function(r){e.$set(e.form,"provisioner",r)},expression:"form.provisioner"}})],1),t("el-form-item",{attrs:{label:"Monitor",prop:"parameters.monitors",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" 172.16.10.10:6389",clearable:""},model:{value:e.form.parameters["monitors"],callback:function(r){e.$set(e.form.parameters,"monitors",r)},expression:"form.parameters['monitors']"}})],1),t("el-form-item",{attrs:{label:"OSD Pool",prop:"parameters.pool",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" kube",clearable:""},model:{value:e.form.parameters["pool"],callback:function(r){e.$set(e.form.parameters,"pool",r)},expression:"form.parameters['pool']"}})],1),t("el-form-item",{attrs:{label:"Admin Id",prop:"parameters.adminId",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" secret",clearable:""},model:{value:e.form.parameters["adminId"],callback:function(r){e.$set(e.form.parameters,"adminId",r)},expression:"form.parameters['adminId']"}})],1),t("el-form-item",{attrs:{label:"Admin Secret Name",prop:"parameters.adminSecretName",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" secret",clearable:""},model:{value:e.form.parameters["adminSecretName"],callback:function(r){e.$set(e.form.parameters,"adminSecretName",r)},expression:"form.parameters['adminSecretName']"}})],1),t("el-form-item",{attrs:{label:"Admin Secret Namespace",prop:"parameters.adminSecretName",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" kube-system",clearable:""},model:{value:e.form.parameters["adminSecretNamespace"],callback:function(r){e.$set(e.form.parameters,"adminSecretNamespace",r)},expression:"form.parameters['adminSecretNamespace']"}})],1),t("el-form-item",{attrs:{label:"User Id",prop:"parameters.userId",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" kube",clearable:""},model:{value:e.form.parameters["userId"],callback:function(r){e.$set(e.form.parameters,"userId",r)},expression:"form.parameters['userId']"}})],1),t("el-form-item",{attrs:{label:"User Secret Name",prop:"parameters.userSecretName",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" secret",clearable:""},model:{value:e.form.parameters["userSecretName"],callback:function(r){e.$set(e.form.parameters,"userSecretName",r)},expression:"form.parameters['userSecretName']"}})],1),t("el-form-item",{attrs:{label:"FS Type",prop:"parameters.fsType",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" ext4",clearable:""},model:{value:e.form.parameters["fsType"],callback:function(r){e.$set(e.form.parameters,"fsType",r)},expression:"form.parameters['fsType']"}})],1),t("el-form-item",{attrs:{label:"ImageFormat",prop:"parameters.imageFormat",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" 2",clearable:""},model:{value:e.form.parameters["imageFormat"],callback:function(r){e.$set(e.form.parameters,"imageFormat",r)},expression:"form.parameters['imageFormat']"}})],1)],1):e._e(),"rook-ceph"===e.createType?t("div",[t("el-form-item",{attrs:{label:e.$t("commons.table.name"),required:""}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.provisioner,callback:function(r){e.$set(e.form,"provisioner",r)},expression:"form.provisioner"}})],1)],1):e._e(),"cinder"===e.createType?t("div",[t("el-form-item",{attrs:{label:e.$t("commons.table.name"),required:""}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.provisioner,callback:function(r){e.$set(e.form,"provisioner",r)},expression:"form.provisioner"}})],1)],1):e._e(),"vsphere"===e.createType?t("div",[t("el-form-item",{attrs:{label:e.$t("commons.table.name"),required:""}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.provisioner,callback:function(r){e.$set(e.form,"provisioner",r)},expression:"form.provisioner"}})],1),t("el-form-item",{attrs:{label:e.$t("cluster.detail.storage.class.storage_policy_type")}},[t("el-radio-group",{model:{value:e.form.parameters["storagePolicyType"],callback:function(r){e.$set(e.form.parameters,"storagePolicyType",r)},expression:"form.parameters['storagePolicyType']"}},[t("el-radio",{attrs:{label:"BuiltIn"}},[e._v(e._s(e.$t("cluster.detail.storage.class.build_in")))]),t("el-radio",{attrs:{label:"Custom"}},[e._v(e._s(e.$t("cluster.detail.storage.class.custom")))])],1)],1),"BuiltIn"===e.form.parameters["storagePolicyType"]?t("el-form-item",{attrs:{label:e.$t("cluster.detail.storage.class.storage_policy"),prop:"parameters.storagePolicyName",rules:e.requiredRules}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.form.parameters["storagePolicyName"],callback:function(r){e.$set(e.form.parameters,"storagePolicyName",r)},expression:"form.parameters['storagePolicyName']"}},[t("el-option",{attrs:{value:"vSAN Default Storage Policy",label:"vSAN Default Storage Policy"}}),t("el-option",{attrs:{value:"Management Storage Policy - Large",label:"Management Storage Policy - Large"}}),t("el-option",{attrs:{value:"Management Storage Policy - Single Node",label:"Management Storage Policy - Single Node"}}),t("el-option",{attrs:{value:"Management Storage policy - Thin",label:"Management Storage policy - Thin"}}),t("el-option",{attrs:{value:"Management Storage Policy - Stretched",label:"Management Storage Policy - Stretched"}})],1)],1):e._e(),"Custom"===e.form.parameters["storagePolicyType"]?t("el-form-item",{attrs:{label:e.$t("cluster.detail.storage.class.storage_policy"),prop:"parameters.storagePolicyName",rules:e.requiredRules}},[t("el-input",{staticStyle:{width:"100%"},model:{value:e.form.parameters["storagePolicyName"],callback:function(r){e.$set(e.form.parameters,"storagePolicyName",r)},expression:"form.parameters['storagePolicyName']"}})],1):e._e()],1):e._e(),"glusterfs"===e.createType?t("div",[t("el-form-item",{attrs:{label:e.$t("commons.table.name"),required:""}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.provisioner,callback:function(r){e.$set(e.form,"provisioner",r)},expression:"form.provisioner"}})],1),t("el-form-item",{attrs:{label:"resturl",prop:"parameters.resturl",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" 172.0.0.1:8081",clearable:""},model:{value:e.form.parameters["resturl"],callback:function(r){e.$set(e.form.parameters,"resturl",r)},expression:"form.parameters['resturl']"}})],1),t("el-form-item",{attrs:{label:"restuser",prop:"parameters.restuser",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" admin",clearable:""},model:{value:e.form.parameters["restuser"],callback:function(r){e.$set(e.form.parameters,"restuser",r)},expression:"form.parameters['restuser']"}})],1),t("el-form-item",{attrs:{label:"restpassword",prop:"parameters.restuserkey",rules:e.passwordRules}},[t("el-input",{attrs:{type:"password",name:"restuserkey",clearable:""},model:{value:e.form.parameters["restuserkey"],callback:function(r){e.$set(e.form.parameters,"restuserkey",r)},expression:"form.parameters['restuserkey']"}})],1),t("el-form-item",{attrs:{label:"Namespace",prop:"parameters.secretNamespace",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" kube-system",clearable:""},model:{value:e.form.parameters["secretNamespace"],callback:function(r){e.$set(e.form.parameters,"secretNamespace",r)},expression:"form.parameters['secretNamespace']"}})],1),t("el-form-item",{attrs:{label:"secretName",prop:"parameters.secretName",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" heketi-secret",clearable:""},model:{value:e.form.parameters["secretName"],callback:function(r){e.$set(e.form.parameters,"secretName",r)},expression:"form.parameters['secretName']"}})],1),t("el-form-item",{attrs:{label:"clusterid",prop:"parameters.clusterid",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" 8a4ff57af81910e8324368a23afe3bdc",clearable:""},model:{value:e.form.parameters["clusterid"],callback:function(r){e.$set(e.form.parameters,"clusterid",r)},expression:"form.parameters['clusterid']"}})],1),t("el-form-item",{attrs:{label:"gidmin",prop:"parameters.gidMin",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" 40000",clearable:""},model:{value:e.form.parameters["gidMin"],callback:function(r){e.$set(e.form.parameters,"gidMin",r)},expression:"form.parameters['gidMin']"}})],1),t("el-form-item",{attrs:{label:"gidmax",prop:"parameters.gidMax",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" 50000",clearable:""},model:{value:e.form.parameters["gidMax"],callback:function(r){e.$set(e.form.parameters,"gidMax",r)},expression:"form.parameters['gidMax']"}})],1),t("el-form-item",{attrs:{label:"volumetype",prop:"parameters.volumetype",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:" replicate:3",clearable:""},model:{value:e.form.parameters["volumetype"],callback:function(r){e.$set(e.form.parameters,"volumetype",r)},expression:"form.parameters['volumetype']"}})],1)],1):e._e(),"oceanstor"===e.createType?t("div",[t("el-form-item",{attrs:{label:e.$t("commons.table.name"),required:""}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.provisioner,callback:function(r){e.$set(e.form,"provisioner",r)},expression:"form.provisioner"}})],1),t("el-form-item",{attrs:{label:"volumeType",prop:"parameters.volumeType",rules:e.requiredRules}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.form.parameters["volumeType"],callback:function(r){e.$set(e.form.parameters,"volumeType",r)},expression:"form.parameters['volumeType']"}},[t("el-option",{attrs:{value:"lun",label:"lun"}},[e._v("lun")]),t("el-option",{attrs:{value:"fs",label:"fs"}},[e._v("fs")])],1)],1),"fs"===e.form.parameters["volumeType"]?t("el-form-item",{attrs:{label:"authClient",prop:"parameters.authClient",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:"demo1,demo2"},model:{value:e.form.parameters["authClient"],callback:function(r){e.$set(e.form.parameters,"authClient",r)},expression:"form.parameters['authClient']"}})],1):e._e(),t("el-form-item",{attrs:{label:"allocType",prop:"parameters.allocType",rules:e.requiredRules}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.form.parameters["allocType"],callback:function(r){e.$set(e.form.parameters,"allocType",r)},expression:"form.parameters['allocType']"}},[t("el-option",{attrs:{value:"thin",label:"thin"}},[e._v("thin")]),t("el-option",{attrs:{value:"thick",label:"thick"}},[e._v("thick")])],1)],1),t("el-form-item",{attrs:{label:"cloneFrom",prop:"parameters.cloneFrom",rules:e.requiredRules}},[t("el-input",{attrs:{clearable:""},model:{value:e.form.parameters["cloneFrom"],callback:function(r){e.$set(e.form.parameters,"cloneFrom",r)},expression:"form.parameters['cloneFrom']"}}),t("div",[t("span",{staticClass:"input-help"},[e._v(e._s(e.$t("cluster.detail.storage.class.clone_form_help")))])])],1),t("el-form-item",{attrs:{label:"cloneSpeed",prop:"parameters.cloneSpeed",rules:e.requiredRules}},[t("el-input",{attrs:{placeholder:"1-4"},model:{value:e.form.parameters["cloneSpeed"],callback:function(r){e.$set(e.form.parameters,"cloneSpeed",r)},expression:"form.parameters['cloneSpeed']"}}),t("div",[t("span",{staticClass:"input-help"},[e._v(e._s(e.$t("cluster.detail.storage.class.clone_speed_help")))])])],1),t("el-form-item",{attrs:{label:"fsType",prop:"parameters.fsType",rules:e.requiredRules}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.form.parameters["fsType"],callback:function(r){e.$set(e.form.parameters,"fsType",r)},expression:"form.parameters['fsType']"}},[t("el-option",{attrs:{value:"ext2",label:"ext2"}},[e._v("ext2")]),t("el-option",{attrs:{value:"ext3",label:"ext3"}},[e._v("ext3")]),t("el-option",{attrs:{value:"ext4",label:"ext4"}},[e._v("ext4")])],1),t("div",[t("span",{staticClass:"input-help"},[e._v(e._s(e.$t("commons.validate.common_name_help")))])])],1)],1):e._e(),t("el-form-item",[t("div",{staticStyle:{float:"right"}},[t("el-button",{on:{click:function(r){return e.onCancel()}}},[e._v(e._s(e.$t("commons.button.cancel")))]),t("el-button",{attrs:{type:"primary",disabled:!(e.createType&&e.form.metadata.name)||e.submitLoading},on:{click:e.onSubmit}},[e._v(e._s(e.$t("commons.button.submit")))])],1)])],1)],1)])],1)],1)},s=[],o=(t("f5bd"),t("be17")),l=t("2429"),i=t("0792"),n={name:"ClusterStorageClassCreate",components:{LayoutContent:o["a"]},data:function(){return{submitLoading:!1,provisioners:[],createType:"",createName:"",provisioner:{},form:{apiVersion:"storage.k8s.io/v1",kind:"StorageClass",metadata:{name:""},provisioner:"",parameters:{storagePolicyType:""}},nameRules:[i["a"].CommonNameRule],requiredRules:[i["a"].RequiredRule],passwordRules:[i["a"].RequiredRule]}},methods:{getProvisioner:function(){var e=this;Object(l["j"])(this.clusterName).then((function(r){e.provisioners=r,e.provisioners.push({name:"kubernetes.io/no-provisioner",type:"local-storage",parameters:{},status:"Running"}),e.dialogClassVisible=!0}))},onSubmit:function(){var e=this;this.$refs["form"].validate((function(r){if(!r)return!1;if(e.submitLoading=!0,"glusterfs"===e.provisioner.type){var t=e.newV1Secrets();Object(l["c"])(e.clusterName,e.form.parameters["secretNamespace"],t).then((function(){e.form.parameters["restuserkey"]&&delete e.form.parameters["restuserkey"],e.addStorageClass()})).catch((function(){e.form.parameters["restuserkey"]&&delete e.form.parameters["restuserkey"],e.addStorageClass()}))}else e.addStorageClass()}))},addStorageClass:function(){var e=this;this.form.parameters["storagePolicyType"]&&delete this.form.parameters["storagePolicyType"],Object(l["d"])(this.clusterName,this.form).then((function(){e.$message({type:"success",message:e.$t("commons.msg.save_success")}),e.submitLoading=!1,e.$router.push({name:"ClusterStorage"})})).catch((function(){e.submitLoading=!1}))},onCancel:function(){this.$router.push({name:"ClusterStorage"})},changeClassType:function(){switch(this.createType=this.provisioner.type,this.form.provisioner=this.provisioner.name,this.createType){case"rook-ceph":this.form.parameters={clusterID:"rook-ceph",pool:"replicapool",imageFormat:"2",imageFeatures:"layering","csi.storage.k8s.io/provisioner-secret-name":"rook-csi-rbd-provisioner","csi.storage.k8s.io/provisioner-secret-namespace":"rook-ceph","csi.storage.k8s.io/controller-expand-secret-name":"rook-csi-rbd-provisioner","csi.storage.k8s.io/controller-expand-secret-namespace":"rook-ceph","csi.storage.k8s.io/node-stage-secret-name":"rook-csi-rbd-node","csi.storage.k8s.io/node-stage-secret-namespace":"rook-ceph","csi.storage.k8s.io/fstype":"ext4"};break;case"vsphere":this.form.parameters={datastore:this.provisioner.vars["datastore"],storagePolicyName:"vSAN Default Storage Policy",storagePolicyType:"BuiltIn"};break;case"glusterfs":this.form.parameters={secretNamespace:"kube-system",restauthenabled:"true",gidMin:"40000",gidMax:"50000",volumetype:"replicate:3"};break;case"cinder":this.form={allowVolumeExpansion:!0};break}},newV1Secrets:function(){return{apiVersion:"v1",kind:"Secret",metadata:{name:this.form.parameters["secretName"],namespace:this.form.parameters["secretNamespace"]},stringData:{key:this.form.parameters["restuserkey"]},type:"kubernetes.io/glusterfs"}}},created:function(){this.clusterName=this.$route.params.name,this.getProvisioner()}},m=n,c=t("5d22"),p=Object(c["a"])(m,a,s,!1,null,"67b82c2c",null);r["default"]=p.exports},2429:function(e,r,t){"use strict";t.d(r,"j",(function(){return u})),t.d(r,"b",(function(){return f})),t.d(r,"l",(function(){return d})),t.d(r,"f",(function(){return b})),t.d(r,"a",(function(){return v})),t.d(r,"i",(function(){return h})),t.d(r,"k",(function(){return g})),t.d(r,"d",(function(){return y})),t.d(r,"h",(function(){return k})),t.d(r,"e",(function(){return _})),t.d(r,"c",(function(){return $})),t.d(r,"g",(function(){return S}));t("2769"),t("0756");var a=t("ff66"),s="/proxy/kubernetes/{cluster_name}/{resource_url}",o=10,l="api/v1/persistentvolumes",i="apis/storage.k8s.io/v1/storageclasses",n="api/v1/persistentvolumes/{name}",m="apis/storage.k8s.io/v1/storageclasses/{name}",c="/api/v1/clusters/provisioner/{cluster_name}",p="api/v1/namespaces/{namespace}/secrets";function u(e){return Object(a["c"])(c.replace("{cluster_name}",e))}function f(e,r){return Object(a["e"])(c.replace("{cluster_name}",e),r)}function d(e,r){var t="/api/v1/clusters/provisioner/sync/{cluster_name}",s=t.replace("{cluster_name}",e);return Object(a["e"])(s,r)}function b(e,r){var t="/api/v1/clusters/provisioner/delete/{cluster_name}",s=t.replace("{cluster_name}",e);return Object(a["e"])(s,r)}function v(e,r){var t=s.replace("{cluster_name}",e).replace("{resource_url}",l);return Object(a["e"])(t,r)}function h(e,r){var t=s.replace("{cluster_name}",e).replace("{resource_url}",l);return t+="?limit="+o,void 0!==r&&null!==r&&(t+="&continue="+r),Object(a["c"])(t)}function g(e,r,t){var l=s.replace("{cluster_name}",e).replace("{resource_url}",i);return t||(l+="?limit="+o),void 0!==r&&null!==r&&(l+="&continue="+r),Object(a["c"])(l)}function y(e,r){var t=s.replace("{cluster_name}",e).replace("{resource_url}",i);return Object(a["e"])(t,r)}function k(e,r){var t=s.replace("{cluster_name}",e).replace("{resource_url}",m).replace("{name}",r);return Object(a["b"])(t)}function _(e,r){var t=s.replace("{cluster_name}",e).replace("{resource_url}",n).replace("{name}",r);return Object(a["b"])(t)}function $(e,r,t){var o=s.replace("{cluster_name}",e).replace("{resource_url}",p.replace("{namespace}",r));return Object(a["e"])(o,t)}function S(e,r,t){var o=s.replace("{cluster_name}",e).replace("{resource_url}",p.replace("{namespace}",r)+"/"+t);return Object(a["b"])(o)}},"43dd":function(e,r,t){e.exports={theme:"#5354bb"}},a026:function(e,r,t){"use strict";t("f5c4")},be17:function(e,r,t){"use strict";var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"content-container"},[e.$slots.description||e.description?t("div",{staticClass:"content-container__description"},[t("el-alert",{attrs:{title:e.description,type:"info"}}),t("br")],1):e._e(),e.$slots.header||e.header?t("div",{staticClass:"content-container__header"},[e._t("header",(function(){return[e.showBack?t("back-button",{attrs:{path:e.backPath,name:e.backName,to:e.backTo}}):e._e(),e._v(" "+e._s(e.header)+" ")]}))],2):e._e(),e.$slots.toolbar?t("div",{staticClass:"content-container__toolbar"},[e._t("toolbar")],2):e._e(),e._t("default")],2)},s=[],o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("el-icon",{staticClass:"back-button",attrs:{name:"back"},nativeOn:{click:function(r){return e.jump.apply(null,arguments)}}})},l=[],i=(t("f5bd"),{name:"BackButton",props:{path:String,name:String,to:Object},methods:{jump:function(){var e=this.path,r=this.name,t=this.to;e&&this.$router.push(e),r&&this.$router.push(r),t&&this.$router.push(t)}}}),n=i,m=(t("eb9f"),t("5d22")),c=Object(m["a"])(n,o,l,!1,null,null,null),p=c.exports,u={name:"LayoutContent",components:{BackButton:p},props:{header:String,description:String,backPath:String,backName:String,backTo:Object},computed:{showBack:function(e){var r=e.backPath,t=e.backName,a=e.backTo;return r||t||a}}},f=u,d=(t("a026"),Object(m["a"])(f,a,s,!1,null,null,null));r["a"]=d.exports},eb9f:function(e,r,t){"use strict";t("43dd")},f5c4:function(e,r,t){e.exports={theme:"#5354bb"}}}]);
//# sourceMappingURL=chunk-3c620bb7.d8b79763.js.map