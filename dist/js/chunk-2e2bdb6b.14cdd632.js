(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e2bdb6b"],{"0600":function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));n("ac1f"),n("5319");var a=n("ff66"),r="/proxy/kubernetes/{cluster_name}/{resource_url}",c="api/v1/namespaces",o="api/v1/namespaces/{namespace}";function i(e){var t=r.replace("{cluster_name}",e).replace("{resource_url}",c);return Object(a["c"])(t)}function u(e,t){var n=r.replace("{cluster_name}",e).replace("{resource_url}",c);return Object(a["e"])(n,t)}function s(e,t){var n=r.replace("{cluster_name}",e).replace("{resource_url}",o).replace("{namespace}",t);return Object(a["b"])(n)}},"74ed":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout-content",{attrs:{header:e.$t("commons.button.create"),"back-to":{name:"authorizeList"}}},[n("el-row",[n("el-col",{attrs:{span:4}},[n("br")]),n("el-col",{attrs:{span:10}},[n("div",{staticClass:"grid-content bg-purple-light"},[n("el-form",{ref:"form",attrs:{"label-position":"left",model:e.form,rules:e.rules,"label-width":"160px"}},[n("el-form-item",{attrs:{label:e.$t("commons.table.name"),prop:"username"}},[n("el-input",{attrs:{clearable:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}}),n("div",[n("span",{staticClass:"input-help"},[e._v(e._s(e.$t("commons.validate.name_help")))])])],1),n("el-form-item",{attrs:{required:"",label:"集群",prop:"clustername"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:function(t){return e.listNamespace(e.index)}},model:{value:e.form.clustername,callback:function(t){e.$set(e.form,"clustername",t)},expression:"form.clustername"}},e._l(e.clusterOptions,(function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1),n("div",{staticClass:"block"},[e._l(e.form.groupList,(function(t,a){return n("div",{key:a,staticClass:"item-group"},[n("div",{staticClass:"buttons"},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==a,expression:"index !== 0"}],on:{click:function(t){return e.deleteItem(a)}}},[e._v("删除")])],1),n("el-form-item",{attrs:{label:"TEMPLATE",prop:"groupList["+a+"].rolename",rules:{required:!0,message:"输入项不能为空",trigger:"change"}}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.rolename,callback:function(n){e.$set(t,"rolename",n)},expression:"item.rolename"}},e._l(e.templateOptions,(function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1),n("el-form-item",{attrs:{label:"NameSpace",rules:{required:!0,message:"输入项不能为空",trigger:"change"},prop:"groupList["+a+"].namespace"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",disabled:!e.form.clustername,multiple:""},model:{value:t.namespace,callback:function(n){e.$set(t,"namespace",n)},expression:"item.namespace"}},e._l(e.nameSpaceOption,(function(e){return n("el-option",{key:e.name,attrs:{label:e.name,value:e.value}})})),1)],1)],1)})),n("el-button",{staticClass:"add",attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")])],2),e.radioOption.length?n("el-form-item",{attrs:{label:"ACCESS",prop:"radio"}},[n("el-radio-group",{model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[n("el-radio",{attrs:{label:"NONE"}},[e._v("NONE")]),n("el-radio",{attrs:{label:e.radioOption[0].metadata.name}},[e._v("READ-ONLY")]),n("el-radio",{attrs:{label:e.radioOption[1].metadata.name}},[e._v("READ-WRITE")])],1)],1):e._e(),n("el-form-item",{staticStyle:{float:"right"}},[n("el-button",{on:{click:function(t){return e.onCancel()}}},[e._v(e._s(e.$t("commons.button.cancel")))]),n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("commons.button.create")))])],1)],1)],1)])],1)],1)},r=[],c=(n("a434"),n("159b"),n("99af"),n("b0c0"),n("4de4"),n("be17")),o=n("0792"),i=n("0600"),u=n("7ea2"),s=n("ea76"),l={name:"HostCreate",components:{LayoutContent:c["a"]},data:function(){return{credentialType:"new",type:"ingress-nginx",form:{username:"",radio:"NONE",clustername:void 0,groupList:[{namespace:[],rolename:void 0}]},rules:{username:[o["a"].RequiredRule],clustername:[o["a"].RequiredRule]},clusterOptions:[],nameSpaceOption:[],templateOptions:[],radioOption:[],groupList:[0],fromName:""}},methods:{add:function(){this.form.groupList.push({namespace:[],rolename:void 0})},deleteItem:function(e){this.form.groupList.splice(e,1)},kubeusers:function(){Object(s["e"])({clustername:this.form.clustername,username:this.form.username}).then((function(){}))},onSubmit:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;if(e.kubeusers(),e.form.groupList.forEach((function(t){t.namespace.forEach((function(n){var a={clustername:e.form.clustername,rolebindingname:"".concat(e.form.username,"___").concat(t.rolename,"___").concat(n),rolename:t.rolename,rolekind:"ClusterRole",subjects:{kind:"ServiceAccount",name:e.form.username,namespace:"permission-manager"},namespace:n,username:e.form.username};Object(s["f"])(a).then((function(){e.$message({type:"success",message:e.$t("commons.msg.create_success")}),e.$router.push({name:"authorizeList"})}))}))})),"NONE"!==e.form.radio){var n={clustername:e.form.clustername,clusterRolebindingName:"".concat(e.form.username,"___").concat(e.form.radio),rolename:e.form.radio,subjects:{kind:"ServiceAccount",name:e.form.username,namespace:"permission-manager"},username:e.form.username};Object(s["a"])(n).then((function(){}))}}))},listNamespace:function(){var e=this;this.form.namespace=[],Object(i["c"])(this.form.clustername).then((function(t){e.nameSpaceOption=t.items,e.nameSpaceOption.forEach((function(e){e.value=e.label=e.metadata.name}))})).catch((function(){}))},getClusters:function(){var e=this;Object(u["p"])(1,1e3,"").then((function(t){e.clusterOptions=t.items,e.clusterOptions.forEach((function(e){e.value=e.label=e.name}))}))},getRbacs:function(){var e=this;Object(s["c"])().then((function(t){e.radioOption=t.items.clusterRoles.filter((function(e){return"template-cluster-resources___admin"===e.metadata.name||"template-cluster-resources___read-only"===e.metadata.name})),e.templateOptions=t.items.clusterRoles.filter((function(e){return"template-namespaced-resources___developer"===e.metadata.name||"template-namespaced-resources___operation"===e.metadata.name})),e.templateOptions.forEach((function(e){e.value=e.metadata.name,e.name="template-namespaced-resources___developer"===e.metadata.name?"developer":"operation"}))})).catch((function(){}))},onCancel:function(){this.$router.push({name:"authorizeList"})}},created:function(){this.getRbacs(),this.getClusters()},computed:{}},m=l,f=(n("aebd"),n("2877")),p=Object(f["a"])(m,a,r,!1,null,"11be57ed",null);t["default"]=p.exports},"7ea2":function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"p",(function(){return l})),n.d(t,"c",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return d})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return h})),n.d(t,"q",(function(){return v})),n.d(t,"h",(function(){return _})),n.d(t,"g",(function(){return g})),n.d(t,"i",(function(){return O})),n.d(t,"n",(function(){return k})),n.d(t,"o",(function(){return j})),n.d(t,"j",(function(){return y}));n("99af"),n("ac1f"),n("5319");var a=n("ff66"),r="/api/v1/clusters",c="/api/v1/clusters/logger/{cluster_name}",o="/api/v1/clusters/provisioner/log/{cluster_name}/{log_id}";function i(e){return Object(a["c"])("".concat(r,"/").concat(e))}function u(e){return Object(a["c"])("".concat(r,"/name/").concat(e))}function s(e){return Object(a["c"])("".concat(r,"/existence/").concat(e))}function l(e,t,n){return Object(a["e"])("".concat(r,"/search?pageNum=").concat(e,"&pageSize=").concat(t),n)}function m(e){return Object(a["e"])("".concat(r),e)}function f(e){return Object(a["c"])("".concat(r,"/health/").concat(e))}function p(e){return Object(a["e"])("".concat(r,"/recover/").concat(e),{})}function d(e,t){return Object(a["b"])("".concat(r,"/").concat(e,"?force=").concat(t))}function b(e){return Object(a["e"])("".concat(r,"/import/"),e)}function h(e){return Object(a["e"])("".concat(r,"/init/").concat(e,"/"),{})}function v(e,t){var n={clusterName:e,version:t};return Object(a["e"])("".concat(r,"/upgrade/"),n)}function _(e){return Object(a["c"])("".concat(r,"/status/").concat(e))}function g(e){return Object(a["c"])(c.replace("{cluster_name}",e))}function O(e,t){return Object(a["c"])(o.replace("{cluster_name}",e).replace("{log_id}",t))}function k(e){window.open("/ui/#/logger?clusterName=".concat(e),"_blank","height=865, width=800, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=yes,location=no, status=no")}function j(e,t){window.open("/ui/#/logger?clusterName=".concat(e,"&logId=").concat(t),"_blank","height=865, width=800, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=yes,location=no, status=no")}function y(e){return Object(a["c"])("".concat(r,"/secret/").concat(e))}},"992c":function(e,t,n){e.exports={theme:"#5354bb"}},a026:function(e,t,n){"use strict";n("992c")},a434:function(e,t,n){"use strict";var a=n("23e7"),r=n("23cb"),c=n("a691"),o=n("50c4"),i=n("7b0b"),u=n("65f0"),s=n("8418"),l=n("1dde"),m=l("splice"),f=Math.max,p=Math.min,d=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m},{splice:function(e,t){var n,a,l,m,h,v,_=i(this),g=o(_.length),O=r(e,g),k=arguments.length;if(0===k?n=a=0:1===k?(n=0,a=g-O):(n=k-2,a=p(f(c(t),0),g-O)),g+n-a>d)throw TypeError(b);for(l=u(_,a),m=0;m<a;m++)h=O+m,h in _&&s(l,m,_[h]);if(l.length=a,n<a){for(m=O;m<g-a;m++)h=m+a,v=m+n,h in _?_[v]=_[h]:delete _[v];for(m=g;m>g-a+n;m--)delete _[m-1]}else if(n>a)for(m=g-a;m>O;m--)h=m+a-1,v=m+n-1,h in _?_[v]=_[h]:delete _[v];for(m=0;m<n;m++)_[m+O]=arguments[m+2];return _.length=g-a+n,l}})},aebd:function(e,t,n){"use strict";n("bb86")},bb86:function(e,t,n){},be17:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-container"},[e.$slots.description||e.description?n("div",{staticClass:"content-container__description"},[n("el-alert",{attrs:{title:e.description,type:"info"}}),n("br")],1):e._e(),e.$slots.header||e.header?n("div",{staticClass:"content-container__header"},[e._t("header",(function(){return[e.showBack?n("back-button",{attrs:{path:e.backPath,name:e.backName,to:e.backTo}}):e._e(),e._v(" "+e._s(e.header)+" ")]}))],2):e._e(),e.$slots.toolbar?n("div",{staticClass:"content-container__toolbar"},[e._t("toolbar")],2):e._e(),e._t("default")],2)},r=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-icon",{staticClass:"back-button",attrs:{name:"back"},nativeOn:{click:function(t){return e.jump.apply(null,arguments)}}})},o=[],i=(n("b0c0"),{name:"BackButton",props:{path:String,name:String,to:Object},methods:{jump:function(){var e=this.path,t=this.name,n=this.to;e&&this.$router.push(e),t&&this.$router.push(t),n&&this.$router.push(n)}}}),u=i,s=(n("eb9f"),n("2877")),l=Object(s["a"])(u,c,o,!1,null,null,null),m=l.exports,f={name:"LayoutContent",components:{BackButton:m},props:{header:String,description:String,backPath:String,backName:String,backTo:Object},computed:{showBack:function(e){var t=e.backPath,n=e.backName,a=e.backTo;return t||n||a}}},p=f,d=(n("a026"),Object(s["a"])(p,a,r,!1,null,null,null));t["a"]=d.exports},ea76:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l}));n("99af");var a=n("ff66"),r="/api/v1/rbacs";function c(e,t,n){return Object(a["c"])("/api/v1/kubeusers/mm?pageNum=".concat(e,"&pageSize=").concat(t,"&condition=").concat(n))}function o(){return Object(a["c"])("".concat(r,"/mm"))}function i(e){return Object(a["e"])("".concat(r,"/rolebinding"),e)}function u(e){return Object(a["e"])("".concat(r,"/clusterrolebinding"),e)}function s(e){return Object(a["e"])("".concat(r,"/kubeconfig"),e)}function l(e){return Object(a["e"])("/api/v1/kubeusers",e)}},eb9f:function(e,t,n){"use strict";n("f574")},f574:function(e,t,n){e.exports={theme:"#5354bb"}}}]);
//# sourceMappingURL=chunk-2e2bdb6b.14cdd632.js.map