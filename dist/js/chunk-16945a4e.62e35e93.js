(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16945a4e"],{"00fb":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("complex-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{selects:e.nsSelection,data:e.data},on:{"update:selects":function(t){e.nsSelection=t}},scopedSlots:e._u([{key:"header",fn:function(){return[n("el-button-group",[n("el-button",{attrs:{size:"small"},on:{click:function(t){return e.create()}}},[e._v(e._s(e.$t("commons.button.create")))]),n("el-button",{attrs:{size:"small",disabled:e.nsSelection.length<1},on:{click:function(t){return e.onDelete()}}},[e._v(e._s(e.$t("commons.button.delete")))])],1)]},proxy:!0}])},[n("el-table-column",{attrs:{type:"selection",selectable:e.isInSystemSpace,fix:""}}),n("el-table-column",{attrs:{label:e.$t("commons.table.name"),"min-width":"100",prop:"metadata.name",fix:""}}),n("el-table-column",{attrs:{label:e.$t("commons.table.status"),"min-width":"100",prop:"status.phase",fix:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return["Terminating"!==a.status.phase?n("div",[n("span"),e._v(e._s(a.status.phase)+" ")]):e._e(),"Terminating"===a.status.phase?n("div",[n("i",{staticClass:"el-icon-loading"}),e._v("       "),n("span",[e._v(e._s(e.$t("commons.status.terminating"))+" ")])]):e._e()]}}])}),n("el-table-column",{attrs:{label:e.$t("commons.table.create_time")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(" "+e._s(e._f("datetimeFormat")(n.metadata.creationTimestamp))+" ")]}}])}),n("fu-table-operations",{attrs:{buttons:e.buttons,label:e.$t("commons.table.action"),fix:""}})],1),n("el-dialog",{attrs:{title:e.$t("commons.button.create"),width:"30%","close-on-click-modal":!1,visible:e.dialogCreateVisible},on:{"update:visible":function(t){e.dialogCreateVisible=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left","label-width":"80px"}},[n("el-form-item",{attrs:{label:e.$t("commons.table.name"),prop:"metadata.name",rules:e.nameRules}},[n("el-input",{staticStyle:{width:"80%"},attrs:{clearable:""},model:{value:e.form.metadata.name,callback:function(t){e.$set(e.form.metadata,"name",t)},expression:"form.metadata.name"}}),n("div",[n("span",{staticClass:"input-help"},[e._v(e._s(e.$t("commons.validate.common_name_help")))])])],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogCreateVisible=!1}}},[e._v(e._s(e.$t("commons.button.cancel")))]),n("el-button",{attrs:{type:"primary",disabled:0===e.form.metadata.name.length||e.submitLoading},on:{click:function(t){return e.submitCreate()}}},[e._v(e._s(e.$t("commons.button.ok")))])],1)],1)],1)},o=[],s=n("30d5"),i=(n("2769"),n("ecf1"),n("f5bd"),n("b1fa"),n("2e6f"),n("af21"),n("86ca")),r=n("0600"),c=n("5671"),l=n("0792"),u={name:"ClusterNamespace",components:{ComplexTable:i["a"]},data:function(){var e=this;return{loading:!1,submitLoading:!1,buttons:[{label:this.$t("commons.button.delete"),icon:"el-icon-delete",click:function(t){e.onDelete(t)},disabled:function(t){return!e.isInSystemSpace(t)}}],form:{apiVersion:"v1",kind:"Namespace",metadata:{name:""}},nameRules:[l["a"].CommonNameRule],nsSelection:[],toolList:[],dialogCreateVisible:!1,clusterName:"",selects:[],data:[],ps:[],timer:{}}},methods:{search:function(){var e=this;this.loading=!0,Object(r["c"])(this.clusterName).then((function(t){e.data=t.items,e.loading=!1})).catch((function(){e.loading=!1}))},create:function(){this.dialogCreateVisible=!0},loadTools:function(){var e=this;Object(c["c"])(this.clusterName).then((function(t){e.toolList=t}))},submitCreate:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;e.submitLoading=!0,Object(r["a"])(e.clusterName,e.form).then((function(){e.$message({type:"success",message:e.$t("commons.msg.create_success")}),e.dialogCreateVisible=!1,e.search(),e.submitLoading=!1})).catch((function(){e.submitLoading=!1,e.dialogCreateVisible=!1}))}))},isInSystemSpace:function(e){var t=["default","kube-public","kube-operator","kube-system","istio-system","kube-node-lease"];return-1===t.indexOf(e.metadata.name)},checkIsEmptyNs:function(e){if(e){var t,n="",a=Object(s["a"])(this.toolList);try{for(a.s();!(t=a.n()).done;){var o=t.value;o.vars["namespace"]===e.metadata.name&&"Waiting"!==o.status&&(n+=o.name+",")}}catch(d){a.e(d)}finally{a.f()}e.toolDetails=n}else{var i,r=Object(s["a"])(this.nsSelection);try{for(r.s();!(i=r.n()).done;){var c,l=i.value,u="",m=Object(s["a"])(this.toolList);try{for(m.s();!(c=m.n()).done;){var f=c.value;f.vars["namespace"]===l.metadata.name&&"Waiting"!==f.status&&(u+=f.name+",")}}catch(d){m.e(d)}finally{m.f()}l.toolDetails=u}}catch(d){r.e(d)}finally{r.f()}}},onDelete:function(e){var t=this;this.checkIsEmptyNs(e),this.$confirm(this.$t("commons.confirm_message.delete"),this.$t("commons.message_box.prompt"),{confirmButtonText:this.$t("commons.button.confirm"),cancelButtonText:this.$t("commons.button.cancel"),type:"warning"}).then((function(){if(t.ps=[],e)e.toolDetails?t.$message({type:"info",message:e.metadata.name+t.$t("cluster.detail.namespace.before_delete")+e.toolDetails}):t.ps.push(Object(r["b"])(t.clusterName,e.metadata.name));else{var n,a=Object(s["a"])(t.nsSelection);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.toolDetails?t.$message({type:"info",message:o.metadata.name+t.$t("cluster.detail.namespace.before_delete")+o.toolDetails}):t.ps.push(Object(r["b"])(t.clusterName,o.metadata.name))}}catch(i){a.e(i)}finally{a.f()}}0!==t.ps.length&&Promise.all(t.ps).then((function(){t.search(),t.$message({type:"success",message:t.$t("commons.msg.op_success")})})).catch((function(){t.search()}))}))},polling:function(){var e=this;this.timer=setInterval((function(){var t,n=!1,a=["Terminating"],o=Object(s["a"])(e.data);try{for(o.s();!(t=o.n()).done;){var i=t.value;if(-1!==a.indexOf(i.status.phase)){n=!0;break}}}catch(c){o.e(c)}finally{o.f()}n&&Object(r["c"])(e.clusterName).then((function(t){e.data=t.items}))}),1e4)}},created:function(){this.clusterName=this.$route.params.name,this.search(),this.loadTools(),this.polling()},destroyed:function(){clearInterval(this.timer)}},m=u,f=n("5d22"),d=Object(f["a"])(m,a,o,!1,null,"6922c841",null);t["default"]=d.exports},"0600":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));n("2769"),n("0756");var a=n("ff66"),o="/proxy/kubernetes/{cluster_name}/{resource_url}",s="api/v1/namespaces",i="api/v1/namespaces/{namespace}";function r(e){var t=o.replace("{cluster_name}",e).replace("{resource_url}",s);return Object(a["c"])(t)}function c(e,t){var n=o.replace("{cluster_name}",e).replace("{resource_url}",s);return Object(a["e"])(n,t)}function l(e,t){var n=o.replace("{cluster_name}",e).replace("{resource_url}",i).replace("{namespace}",t);return Object(a["b"])(n)}},"1a55":function(e,t,n){"use strict";n("2a6b")},"2a6b":function(e,t,n){e.exports={theme:"#5354bb"}},"30d5":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("79fd"),n("45af"),n("b1fa"),n("1ec5"),n("2e6f"),n("af21");var a=n("ec81");function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Object(a["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,s=function(){};return{s:s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){c=!0,i=e},f:function(){try{r||null==n["return"]||n["return"]()}finally{if(c)throw i}}}}},5671:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return c}));var a=n("ff66"),o="/api/v1/clusters/tool";function s(e){return Object(a["c"])("".concat(o,"/").concat(e))}function i(e,t){return Object(a["e"])("".concat(o,"/enable/").concat(e),t)}function r(e,t){return Object(a["e"])("".concat(o,"/disable/").concat(e),t)}function c(e,t){return Object(a["e"])("".concat(o,"/upgrade/").concat(e),t)}},"78d4":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"86ca":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"complex-table"},[e.$slots.header||e.header?n("div",{staticClass:"complex-table__header"},[e._t("header",(function(){return[e._v(e._s(e.header))]})),e.$slots.toolbar||e.searchConfig?n("div",{staticClass:"complex-table__toolbar"},[n("div",[e._t("toolbar")],2),n("fu-search-bar",e._b({on:{exec:e.search},scopedSlots:e._u([{key:"complex",fn:function(){return[e._t("complex")]},proxy:!0}],null,!0)},"fu-search-bar",e.searchConfig,!1),[e._t("buttons"),n("fu-table-column-select",{attrs:{columns:e.columns}})],2)],1):e._e()],2):e._e(),n("div",{staticClass:"complex-table__body"},[n("fu-table",e._g(e._b({attrs:{columns:e.columns,"local-key":e.localKey},on:{"selection-change":e.handleSelectionChange}},"fu-table",e.$attrs,!1),e.$listeners),[e._t("default")],2)],1),e.$slots.pagination||e.paginationConfig?n("div",{staticClass:"complex-table__pagination"},[e._t("pagination",(function(){return[n("fu-table-pagination",e._b({attrs:{"current-page":e.paginationConfig.currentPage,"page-size":e.paginationConfig.pageSize},on:{"update:currentPage":function(t){return e.$set(e.paginationConfig,"currentPage",t)},"update:current-page":function(t){return e.$set(e.paginationConfig,"currentPage",t)},"update:pageSize":function(t){return e.$set(e.paginationConfig,"pageSize",t)},"update:page-size":function(t){return e.$set(e.paginationConfig,"pageSize",t)},change:e.search}},"fu-table-pagination",e.paginationConfig,!1))]}))],2):e._e()])},o=[],s={name:"ComplexTable",props:{columns:{type:Array,default:function(){return[]}},localKey:String,header:String,searchConfig:Object,paginationConfig:Object,selects:Array},data:function(){return{condition:{}}},methods:{search:function(e,t){e&&(this.condition=e),this.$emit("search",this.condition,t)},handleSelectionChange:function(e){this.$emit("update:selects",e)}}},i=s,r=(n("1a55"),n("5d22")),c=Object(r["a"])(i,a,o,!1,null,null,null);t["a"]=c.exports},ecf1:function(e,t,n){"use strict";var a=n("6c87"),o=n("9f69"),s=n("e08f"),i=n("78d4"),r=n("1392");a("search",(function(e,t,n){return[function(t){var n=s(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,n):new RegExp(t)[e](String(n))},function(e){var a=n(t,this,e);if(a.done)return a.value;var s=o(this),c=String(e),l=s.lastIndex;i(l,0)||(s.lastIndex=0);var u=r(s,c);return i(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))}}]);
//# sourceMappingURL=chunk-16945a4e.62e35e93.js.map