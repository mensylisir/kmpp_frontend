(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e5fd4b1"],{2413:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("layout-content",{attrs:{header:t.$t("commons.button.edit"),"back-to":{name:"ZoneList"}}},[o("el-row",[o("el-col",{attrs:{span:4}},[o("br")]),o("el-col",{attrs:{span:10}},[o("div",{staticClass:"grid-content bg-purple-light"},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",attrs:{"label-width":"200px",model:t.form,rules:t.rules,"label-position":"left"}},[o("el-form-item",{attrs:{label:t.$t("commons.table.name"),prop:"name"}},[o("el-input",{attrs:{disabled:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),"vSphere"===t.form.provider||"FusionCompute"===t.form.provider?o("div",[o("el-form-item",{attrs:{label:t.$t("automatic.zone.datastore_type"),prop:"cloudVars.datastoreType"}},[o("el-radio-group",{model:{value:t.form.cloudVars.datastoreType,callback:function(e){t.$set(t.form.cloudVars,"datastoreType",e)},expression:"form.cloudVars.datastoreType"}},[o("el-radio",{attrs:{label:"value"}},[t._v(t._s(t.$t("automatic.zone.value")))]),o("el-radio",{attrs:{label:"usage"}},[t._v(t._s(t.$t("automatic.zone.usage")))])],1)],1),o("el-form-item",{attrs:{label:t.$t("automatic.zone.old_datastores"),prop:"oldDatastores"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"","reserve-keyword":"",disabled:""},model:{value:t.oldDatastores,callback:function(e){t.oldDatastores=e},expression:"oldDatastores"}})],1),o("el-form-item",{attrs:{label:t.$t("automatic.zone.new_datastores"),prop:"chooseDatastores"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"","reserve-keyword":""},model:{value:t.newDatastores,callback:function(e){t.newDatastores=e},expression:"newDatastores"}},t._l(t.cloudDatastores,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.name}})})),1)],1)],1):t._e(),o("el-form-item",{attrs:{label:t.$t("automatic.ip_pool.name"),prop:"ipPoolName"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"","reserve-keyword":""},on:{change:function(e){return t.changeIpPool()}},model:{value:t.form.ipPoolName,callback:function(e){t.$set(t.form,"ipPoolName",e)},expression:"form.ipPoolName"}},t._l(t.ipPools,(function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.name}})})),1)],1),o("el-form-item",[o("div",{staticStyle:{float:"right"}},[o("el-button",{on:{click:function(e){return t.onCancel()}}},[t._v(t._s(t.$t("commons.button.cancel")))]),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit("form")}}},[t._v(t._s(t.$t("commons.button.submit")))])],1)])],1),o("h3",[t._v(t._s(t.$t("automatic.ip_pool.name")))]),t.currentPool?o("table",{staticClass:"el-table"},[o("tbody",[o("tr",[o("th",[t._v(t._s(t.$t("commons.table.name")))]),o("td",[t._v(t._s(t.currentPool.name))])]),o("tr",[o("th",[t._v(t._s(t.$t("automatic.ip_pool.subnet")))]),o("td",[t._v(t._s(t.currentPool.subnet))])]),o("tr",[o("th",[t._v(t._s(t.$t("automatic.ip_pool.gateway")))]),t.currentPool.ips.length>0?o("td",[t._v(t._s(t.currentPool.ips[0].gateway))]):t._e()]),o("tr",[o("th",[t._v(t._s(t.$t("automatic.ip_pool.dns1")))]),t.currentPool.ips.length>0?o("td",[t._v(t._s(t.currentPool.ips[0].dns1))]):t._e()]),o("tr",[o("th",[t._v(t._s(t.$t("automatic.ip_pool.dns2")))]),t.currentPool.ips.length>0?o("td",[t._v(t._s(t.currentPool.ips[0].dns2))]):t._e()]),o("tr",[o("th",[t._v(t._s(t.$t("automatic.ip_pool.ip_usage")))]),o("td",[t._v(t._s(t.currentPool.ipUsed)+"/"+t._s(t.currentPool.ips.length))])])])]):t._e()],1)])],1)],1)},a=[],r=o("30d5"),c=(o("f5bd"),o("a5c9"),o("b1fa"),o("be17")),s=o("dd3c"),u=o("6560"),i={name:"ZoneEdit",components:{LayoutContent:c["a"]},props:["name"],data:function(){return{form:{name:"",ipPoolName:"",cloudVars:{datastoreType:"",datastore:""},provider:""},rules:{},loading:!1,ipPools:[],cloudDatastores:[],cloudZoneRequest:{regionName:"",cloudVars:{}},newDatastores:[],oldDatastores:[],currentPool:{ips:[],ipUsed:0}}},methods:{onCancel:function(){this.$router.push({name:"ZoneList"})},changeIpPool:function(){var t,e=Object(r["a"])(this.ipPools);try{for(e.s();!(t=e.n()).done;){var o=t.value;if(this.form.ipPoolName===o.name){this.currentPool=o;break}}}catch(n){e.e(n)}finally{e.f()}},onSubmit:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;"vSphere"!==e.form.provider&&"FusionCompute"!==e.form.provider||(e.form.cloudVars["datastore"]instanceof Array?e.form.cloudVars["datastore"]=e.form.cloudVars["datastore"].concat(e.newDatastores):e.form.cloudVars["datastore"].length>0&&(e.newDatastores.push(e.form.cloudVars["datastore"]),e.form.cloudVars["datastore"]=e.newDatastores)),e.loading=!0,Object(s["i"])(e.form.name,e.form).then((function(){e.loading=!1,e.$message({type:"success",message:e.$t("commons.msg.save_success")}),e.$router.push({name:"ZoneList"})})).finally((function(){e.loading=!1}))}))}},created:function(){var t=this;this.loading=!0,Object(s["c"])(this.name).then((function(e){t.form=e,Object(u["e"])().then((function(e){t.ipPools=e.items,t.changeIpPool()})),t.oldDatastores=t.form.cloudVars["datastore"],"vSphere"!==t.form.provider&&"FusionCompute"!==t.form.provider||(t.cloudZoneRequest.cloudVars=t.form.cloudVars,t.cloudZoneRequest.regionName=t.form.regionName,Object(s["f"])(t.cloudZoneRequest).then((function(e){if(t.form.cloudVars["datastore"]instanceof Array){var o,n=t.form.cloudVars["datastore"],a=Object(r["a"])(e);try{for(a.s();!(o=a.n()).done;){var c,s=o.value,u=!1,i=Object(r["a"])(n);try{for(i.s();!(c=i.n()).done;){var l=c.value;s.name===l&&(u=!0)}}catch(b){i.e(b)}finally{i.f()}u||t.cloudDatastores.push(s)}}catch(b){a.e(b)}finally{a.f()}}else{var d,f=t.form.cloudVars["datastore"],m=Object(r["a"])(e);try{for(m.s();!(d=m.n()).done;){var p=d.value;p.name!==f&&t.cloudDatastores.push(p)}}catch(b){m.e(b)}finally{m.f()}}}))),t.loading=!1}))}},l=i,d=o("5d22"),f=Object(d["a"])(l,n,a,!1,null,"2d288ca7",null);e["default"]=f.exports},6560:function(t,e,o){"use strict";o.d(e,"e",(function(){return r})),o.d(e,"d",(function(){return c})),o.d(e,"b",(function(){return s})),o.d(e,"g",(function(){return u})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return l})),o.d(e,"h",(function(){return d})),o.d(e,"f",(function(){return f})),o.d(e,"i",(function(){return m}));o("a5c9");var n=o("ff66"),a="/api/v1/ippools";function r(){return Object(n["c"])("".concat(a))}function c(t){return Object(n["b"])("".concat(a,"/").concat(t))}function s(t){return Object(n["e"])(a,t)}function u(t,e,o){return Object(n["e"])("".concat(a,"/search?pageNum=").concat(t,"&pageSize=").concat(e),o)}function i(t,e){return Object(n["b"])("".concat(a,"/").concat(t,"/ips/").concat(e))}function l(t,e){return Object(n["e"])("".concat(a,"/").concat(t,"/ips"),e)}function d(t){return Object(n["d"])("".concat(a,"/").concat(t,"/ips/sync"))}function f(t,e,o,r){return Object(n["e"])("".concat(a,"/").concat(o,"/ips/search?pageNum=").concat(t,"&pageSize=").concat(e),r)}function m(t,e,o){return Object(n["d"])("".concat(a,"/").concat(t,"/ips/").concat(e),o)}},dd3c:function(t,e,o){"use strict";o.d(e,"b",(function(){return r})),o.d(e,"h",(function(){return c})),o.d(e,"e",(function(){return s})),o.d(e,"f",(function(){return u})),o.d(e,"g",(function(){return i})),o.d(e,"a",(function(){return l})),o.d(e,"d",(function(){return d})),o.d(e,"c",(function(){return f})),o.d(e,"i",(function(){return m}));o("a5c9");var n=o("ff66"),a="/api/v1/zones";function r(t){return Object(n["b"])(a+"/"+t)}function c(t,e,o){return Object(n["e"])("".concat(a,"/search?pageNum=").concat(t,"&pageSize=").concat(e),o)}function s(t){return Object(n["e"])("".concat(a,"/clusters"),t)}function u(t){return Object(n["e"])("".concat(a,"/datastores"),t)}function i(t){return Object(n["e"])("".concat(a,"/templates"),t)}function l(t){return Object(n["e"])("".concat(a),t)}function d(t){return Object(n["c"])("".concat(a,"/list/").concat(t))}function f(t){return Object(n["c"])("".concat(a,"/").concat(t))}function m(t,e){return Object(n["d"])("".concat(a,"/").concat(t),e)}}}]);
//# sourceMappingURL=chunk-7e5fd4b1.57f9f66e.js.map