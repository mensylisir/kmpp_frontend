(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e06a001e"],{2406:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login-background"},[r("div",{staticClass:"login-container"},[r("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"flex"}},[r("el-col",{attrs:{span:12}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,size:"default"}},[r("div",{staticClass:"login-title"},[e._v(" "+e._s(e.systemName)+" ")]),r("div",{staticClass:"login-border"}),r("div",{staticClass:"login-welcome"},[e._v(" "+e._s(e.$t("login.welcome"))+" ")]),r("div",{staticClass:"login-form"},[r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{attrs:{placeholder:e.$t("login.username"),autofocus:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:e.$t("login.password"),maxlength:"30"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e.hasCode?r("el-form-item",[r("el-col",{attrs:{span:18}},[r("el-form-item",{attrs:{prop:"code"}},[r("el-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",[r("el-image",{staticStyle:{float:"right"},attrs:{src:e.captcha.image},on:{click:e.createCaptcha}})],1)],1)],1):e._e()],1),r("div",{staticClass:"login-btn"},[r("el-button",{staticClass:"submit",attrs:{type:"primary",size:"default"},on:{click:function(t){return e.submit("form")}}},[e._v(" "+e._s(e.$t("commons.button.login"))+" ")])],1),r("div",{staticClass:"forget-password"},[r("a",{staticStyle:{color:"#999999","text-decoration-line":"underline"},on:{click:e.forgetPassword}},[e._v(e._s(e.$t("login.forget_password"))+"?")])])])],1),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"login-image"})])],1)],1),r("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingPage,expression:"loadingPage"}],attrs:{title:e.$t("login.reset_password"),visible:e.opened,width:"30%"},on:{"update:visible":function(t){e.opened=t}}},[r("el-form",{ref:"forgetForm",attrs:{model:e.forgetForm,rules:e.forgetRules,size:"default"}},[r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{attrs:{placeholder:e.$t("login.username"),autofocus:""},model:{value:e.forgetForm.username,callback:function(t){e.$set(e.forgetForm,"username",t)},expression:"forgetForm.username"}})],1),r("el-form-item",{attrs:{prop:"email"}},[r("el-input",{attrs:{placeholder:e.$t("login.email"),autofocus:""},model:{value:e.forgetForm.email,callback:function(t){e.$set(e.forgetForm,"email",t)},expression:"forgetForm.email"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.opened=!1}}},[e._v(e._s(e.$t("commons.button.cancel")))]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForget("forgetForm")}}},[e._v(e._s(e.$t("commons.button.submit")))])],1)],1)],1)},a=[],s=(r("2070"),r("e1d4"),r("b1fa"),r("c5ce8"),r("12de")),i=r("3786"),n={name:"Login",data:function(){return{loading:!1,form:{username:"",password:"",captchaId:"",code:""},rules:{username:[{required:!0,message:this.$tm("commons.validate.input","login.username"),trigger:"blur"}],password:[{required:!0,message:this.$tm("commons.validate.input","login.password"),trigger:"blur"},{min:6,max:30,message:this.$t("commons.validate.limit",[6,30]),trigger:"blur"}],code:[{required:!0,message:this.$tm("commons.validate.input","login.captcha"),trigger:"blur"}]},msg:"",redirect:void 0,otherQuery:{},systemName:this.$t("login.title"),captcha:{image:""},hasCode:!1,opened:!1,forgetForm:{username:"",email:""},forgetRules:{username:[{required:!0,message:this.$tm("commons.validate.input","login.username"),trigger:"blur"}],email:[{required:!0,message:this.$tm("commons.validate.input","login.email"),trigger:"blur"}]},loadingPage:!1}},watch:{$route:{handler:function(e){var t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}},created:function(){document.addEventListener("keydown",this.watchEnter),this.getSystemName(),this.checkErrorNum()},destroyed:function(){document.removeEventListener("keydown",this.watchEnter)},methods:{watchEnter:function(e){var t=e.keyCode;13===t&&(this.opened?this.submitForget("forgetForm"):this.submit("form"))},submit:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,t.form.captchaId=t.captcha.captchaId,t.$store.dispatch("user/login",t.form).then((function(){t.$router.push({path:t.redirect||"/",query:t.otherQuery}),t.loading=!1,localStorage.removeItem("loginErrorNum")})).catch((function(e){t.handleError(e),t.loading=!1}))}))},getOtherQuery:function(e){return Object.keys(e).reduce((function(t,r){return"redirect"!==r&&(t[r]=e[r]),t}),{})},getSystemName:function(){var e=this;Object(s["a"])().then((function(t){""!==t.systemName&&(e.systemName=t.systemName)})).catch((function(){return e.systemName=e.$t("login.title")}))},checkErrorNum:function(){if(null!=localStorage.getItem("loginErrorNum")){var e=Number(localStorage.getItem("loginErrorNum"));e>=3&&this.createCaptcha()}},createCaptcha:function(){var e=this;Object(i["a"])().then((function(t){e.captcha=t,e.hasCode=!0}))},forgetPassword:function(){this.opened=!0},submitForget:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.loadingPage=!0,Object(i["f"])(t.forgetForm).then((function(){t.$message({type:"success",message:t.$t("login.reset_message")}),t.opened=!1,t.loadingPage=!1})).finally((function(){t.loadingPage=!1}))}))},handleError:function(e){if(this.msg=e,null!=localStorage.getItem("loginErrorNum")){var t=Number(localStorage.getItem("loginErrorNum"));if(t>=3)this.createCaptcha();else{var r=t+1;localStorage.setItem("loginErrorNum",r.toString())}}else localStorage.setItem("loginErrorNum","1")}}},l=n,c=(r("e5e9"),r("5d22")),m=Object(c["a"])(l,o,a,!1,null,"cd6bb502",null);t["default"]=m.exports},a219:function(e,t,r){},c5ce8:function(e,t,r){"use strict";var o=r("6c39"),a=r("9f69"),s=r("d50e"),i=r("f91c"),n="toString",l=RegExp.prototype,c=l[n],m=s((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u=c.name!=n;(m||u)&&o(RegExp.prototype,n,(function(){var e=a(this),t=String(e.source),r=e.flags,o=String(void 0===r&&e instanceof RegExp&&!("flags"in l)?i.call(e):r);return"/"+t+"/"+o}),{unsafe:!0})},e5e9:function(e,t,r){"use strict";r("a219")}}]);
//# sourceMappingURL=chunk-e06a001e.370a9512.js.map