(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-079b0ba8"],{"00fb":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("complex-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{selects:t.nsSelection,data:t.nameSpaceList,"pagination-config":t.paginationConfig},on:{"update:selects":function(e){t.nsSelection=e}},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",[n("el-button",{attrs:{size:"small",type:"primary",disabled:!0,icon:"el-icon-plus"},on:{click:function(e){return t.create()}}},[t._v(t._s(t.$t("commons.button.create")))]),n("el-button",{attrs:{size:"small",disabled:!0}},[t._v(t._s(t.$t("commons.button.delete")))])],1)]},proxy:!0}])},[n("el-table-column",{attrs:{type:"selection",selectable:t.isInSystemSpace,fix:""}}),n("el-table-column",{attrs:{label:t.$t("commons.table.name"),"min-width":"100",prop:"metadata.name",fix:""}}),n("el-table-column",{attrs:{label:t.$t("commons.table.status"),"min-width":"100",prop:"status.phase",fix:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return["Terminating"!==a.status.phase?n("div",[n("span"),t._v(t._s(a.status.phase)+" ")]):t._e(),"Terminating"===a.status.phase?n("div",[n("i",{staticClass:"el-icon-loading"}),t._v("       "),n("span",[t._v(t._s(t.$t("commons.status.terminating"))+" ")])]):t._e()]}}])}),n("el-table-column",{attrs:{label:t.$t("commons.table.create_time")},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(" "+t._s(t._f("datetimeFormat")(n.metadata.creationTimestamp))+" ")]}}])}),n("fu-table-operations",{attrs:{buttons:t.buttons,label:t.$t("commons.table.action"),fix:""}})],1),n("el-dialog",{attrs:{title:t.$t("commons.button.create"),width:"30%","close-on-click-modal":!1,visible:t.dialogCreateVisible},on:{"update:visible":function(e){t.dialogCreateVisible=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-position":"left","label-width":"80px"}},[n("el-form-item",{attrs:{label:t.$t("commons.table.name"),prop:"metadata.name",rules:t.nameRules}},[n("el-input",{staticStyle:{width:"80%"},attrs:{clearable:""},model:{value:t.form.metadata.name,callback:function(e){t.$set(t.form.metadata,"name",e)},expression:"form.metadata.name"}}),n("div",[n("span",{staticClass:"input-help"},[t._v(t._s(t.$t("commons.validate.common_name_help")))])])],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogCreateVisible=!1}}},[t._v(t._s(t.$t("commons.button.cancel")))]),n("el-button",{attrs:{type:"primary",disabled:0===t.form.metadata.name.length||t.submitLoading},on:{click:function(e){return t.submitCreate()}}},[t._v(t._s(t.$t("commons.button.ok")))])],1)],1)],1)},o=[],i=n("b85c"),s=(n("4de4"),n("ac1f"),n("841c"),n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),n("86ca")),c=n("0600"),r=n("5671"),l=n("0792"),u={name:"ClusterNamespace",components:{ComplexTable:s["a"]},props:["name"],data:function(){var t=this;return{loading:!1,submitLoading:!1,buttons:[{label:this.$t("commons.button.delete"),icon:"el-icon-delete",click:function(e){t.onDelete(e)},disabled:function(e){return!t.isInSystemSpace(e)}}],form:{apiVersion:"v1",kind:"Namespace",metadata:{name:""}},nameRules:[l["a"].CommonNameRule],nsSelection:[],toolList:[],dialogCreateVisible:!1,clusterName:"",selects:[],data:[],ps:[],timer:{},paginationConfig:{currentPage:1,pageSize:10,total:0}}},computed:{nameSpaceList:function(){var t=this,e=this.data.filter((function(e,n){return t.paginationConfig.pageSize*(t.paginationConfig.currentPage-1)<=n&&n<t.paginationConfig.pageSize*t.paginationConfig.currentPage}));return e}},methods:{search:function(){var t=this;this.loading=!0,Object(c["c"])(this.clusterName).then((function(e){t.data=e.items,t.paginationConfig.total=e.items.length,t.loading=!1})).catch((function(){t.loading=!1}))},create:function(){this.dialogCreateVisible=!0},loadTools:function(){var t=this;Object(r["c"])(this.clusterName).then((function(e){t.toolList=e}))},submitCreate:function(){var t=this;this.$refs["form"].validate((function(e){if(!e)return!1;t.submitLoading=!0,Object(c["a"])(t.clusterName,t.form).then((function(){t.$message({type:"success",message:t.$t("commons.msg.create_success")}),t.dialogCreateVisible=!1,t.search(),t.submitLoading=!1})).catch((function(){t.submitLoading=!1,t.dialogCreateVisible=!1}))}))},isInSystemSpace:function(t){var e=["default","kube-public","kube-operator","kube-system","istio-system","kube-node-lease"];return-1===e.indexOf(t.metadata.name)},checkIsEmptyNs:function(t){if(t){var e,n="",a=Object(i["a"])(this.toolList);try{for(a.s();!(e=a.n()).done;){var o=e.value;o.vars["namespace"]===t.metadata.name&&"Waiting"!==o.status&&(n+=o.name+",")}}catch(d){a.e(d)}finally{a.f()}t.toolDetails=n}else{var s,c=Object(i["a"])(this.nsSelection);try{for(c.s();!(s=c.n()).done;){var r,l=s.value,u="",m=Object(i["a"])(this.toolList);try{for(m.s();!(r=m.n()).done;){var f=r.value;f.vars["namespace"]===l.metadata.name&&"Waiting"!==f.status&&(u+=f.name+",")}}catch(d){m.e(d)}finally{m.f()}l.toolDetails=u}}catch(d){c.e(d)}finally{c.f()}}},onDelete:function(t){var e=this;this.checkIsEmptyNs(t),this.$confirm(this.$t("commons.confirm_message.delete"),this.$t("commons.message_box.prompt"),{confirmButtonText:this.$t("commons.button.confirm"),cancelButtonText:this.$t("commons.button.cancel"),type:"warning"}).then((function(){if(e.ps=[],t)t.toolDetails?e.$message({type:"info",message:t.metadata.name+e.$t("cluster.detail.namespace.before_delete")+t.toolDetails}):e.ps.push(Object(c["b"])(e.clusterName,t.metadata.name));else{var n,a=Object(i["a"])(e.nsSelection);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.toolDetails?e.$message({type:"info",message:o.metadata.name+e.$t("cluster.detail.namespace.before_delete")+o.toolDetails}):e.ps.push(Object(c["b"])(e.clusterName,o.metadata.name))}}catch(s){a.e(s)}finally{a.f()}}0!==e.ps.length&&Promise.all(e.ps).then((function(){e.search(),e.$message({type:"success",message:e.$t("commons.msg.op_success")})})).catch((function(){e.search()}))}))},polling:function(){var t=this;this.timer=setInterval((function(){var e,n=!1,a=["Terminating"],o=Object(i["a"])(t.data);try{for(o.s();!(e=o.n()).done;){var s=e.value;if(-1!==a.indexOf(s.status.phase)){n=!0;break}}}catch(r){o.e(r)}finally{o.f()}n&&Object(c["c"])(t.clusterName).then((function(e){t.data=e.items}))}),1e4)}},created:function(){this.clusterName=this.name,this.search(),this.loadTools(),this.polling()},destroyed:function(){clearInterval(this.timer)}},m=u,f=n("2877"),d=Object(f["a"])(m,a,o,!1,null,"51665402",null);e["default"]=d.exports},"0600":function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return l}));n("ac1f"),n("5319");var a=n("ff66"),o="/proxy/kubernetes/{cluster_name}/{resource_url}",i="api/v1/namespaces",s="api/v1/namespaces/{namespace}";function c(t){var e=o.replace("{cluster_name}",t).replace("{resource_url}",i);return Object(a["c"])(e)}function r(t,e){var n=o.replace("{cluster_name}",t).replace("{resource_url}",i);return Object(a["e"])(n,e)}function l(t,e){var n=o.replace("{cluster_name}",t).replace("{resource_url}",s).replace("{namespace}",e);return Object(a["b"])(n)}},"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"1a55":function(t,e,n){"use strict";n("648b")},5671:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return r}));var a=n("ff66"),o="/api/v1/clusters/tool";function i(t){return Object(a["c"])("".concat(o,"/").concat(t))}function s(t,e){return Object(a["e"])("".concat(o,"/enable/").concat(t),e)}function c(t,e){return Object(a["e"])("".concat(o,"/disable/").concat(t),e)}function r(t,e){return Object(a["e"])("".concat(o,"/upgrade/").concat(t),e)}},"648b":function(t,e,n){t.exports={theme:"#5354bb"}},"841c":function(t,e,n){"use strict";var a=n("d784"),o=n("825a"),i=n("1d80"),s=n("129f"),c=n("577e"),r=n("14c3");a("search",(function(t,e,n){return[function(e){var n=i(this),a=void 0==e?void 0:e[t];return void 0!==a?a.call(e,n):new RegExp(e)[t](c(n))},function(t){var a=o(this),i=c(t),l=n(e,a,i);if(l.done)return l.value;var u=a.lastIndex;s(u,0)||(a.lastIndex=0);var m=r(a,i);return s(a.lastIndex,u)||(a.lastIndex=u),null===m?-1:m.index}]}))},"86ca":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"complex-table"},[t.$slots.header||t.header?n("div",{staticClass:"complex-table__header"},[t._t("header",(function(){return[t._v(t._s(t.header))]})),t.$slots.toolbar||t.searchConfig?n("div",{staticClass:"complex-table__toolbar"},[n("div",[t._t("toolbar")],2),n("fu-search-bar",t._b({on:{exec:t.search},scopedSlots:t._u([{key:"complex",fn:function(){return[t._t("complex")]},proxy:!0}],null,!0)},"fu-search-bar",t.searchConfig,!1),[t._t("buttons"),n("fu-table-column-select",{attrs:{columns:t.columns}})],2)],1):t._e()],2):t._e(),n("div",{staticClass:"complex-table__body"},[n("fu-table",t._g(t._b({attrs:{columns:t.columns,"local-key":t.localKey},on:{"selection-change":t.handleSelectionChange}},"fu-table",t.$attrs,!1),t.$listeners),[t._t("default")],2)],1),t.$slots.pagination||t.paginationConfig?n("div",{staticClass:"complex-table__pagination"},[t._t("pagination",(function(){return[n("fu-table-pagination",t._b({attrs:{"current-page":t.paginationConfig.currentPage,"page-size":t.paginationConfig.pageSize},on:{"update:currentPage":function(e){return t.$set(t.paginationConfig,"currentPage",e)},"update:current-page":function(e){return t.$set(t.paginationConfig,"currentPage",e)},"update:pageSize":function(e){return t.$set(t.paginationConfig,"pageSize",e)},"update:page-size":function(e){return t.$set(t.paginationConfig,"pageSize",e)},change:t.search}},"fu-table-pagination",t.paginationConfig,!1))]}))],2):t._e()])},o=[],i={name:"ComplexTable",props:{columns:{type:Array,default:function(){return[]}},localKey:String,header:String,searchConfig:Object,paginationConfig:Object,selects:Array},data:function(){return{condition:{}}},methods:{search:function(t,e){t&&(this.condition=t),this.$emit("search",this.condition,e)},handleSelectionChange:function(t){this.$emit("update:selects",t)}}},s=i,c=(n("1a55"),n("2877")),r=Object(c["a"])(s,a,o,!1,null,null,null);e["a"]=r.exports},b85c:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");var a=n("06c5");function o(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Object(a["a"])(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,r=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){r=!0,s=t},f:function(){try{c||null==n["return"]||n["return"]()}finally{if(r)throw s}}}}}}]);
//# sourceMappingURL=chunk-079b0ba8.e7a72c55.js.map