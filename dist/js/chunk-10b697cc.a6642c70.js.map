{"version":3,"sources":["webpack:///./src/api/cluster.js","webpack:///./src/business/clusters/import/index.vue?7189","webpack:///src/business/clusters/import/index.vue","webpack:///./src/business/clusters/import/index.vue?d45c","webpack:///./src/business/clusters/import/index.vue"],"names":["clusterUrl","clusterLoggerUrl","storageProvisionerLoggerUrl","getClusterByName","clusterName","get","getClusterByProject","projectNames","checkClusterNameExistence","searchClusters","page","size","condition","post","createCluster","data","healthCheck","clusterRecover","deleteCluster","force","del","importCluster","allClusters","initCluster","upgradeCluster","version","req","getClusterStatus","getClusterLog","replace","getProvisionerLog","logId","openLogger","window","open","openProvisionerLogger","getSecret","render","_vm","this","_h","$createElement","_c","_self","attrs","$t","name","staticClass","ref","form","rules","staticStyle","model","value","callback","$$v","$set","expression","_n","_l","item","key","_v","_s","minRows","on","$event","onCancel","directives","rawName","onSubmit","staticRenderFns","components","loadding","projects","apiServer","token","router","projectName","methods","$refs","validate","valid","getProjects","$router","push","created","component"],"mappings":"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","file":"js/chunk-10b697cc.a6642c70.js","sourcesContent":["import {get, post, del} from \"@/plugins/request\"\n\nconst clusterUrl = \"/api/v1/clusters\"\nconst clusterLoggerUrl = \"/api/v1/clusters/logger/{cluster_name}\"\nconst clusterNodeLoggerUrl = \"/api/v1/clusters/node/logger/{cluster_name}/{node_name}\"\nconst storageProvisionerLoggerUrl = \"/api/v1/clusters/provisioner/log/{cluster_name}/{log_id}\"\n\nexport function getClusterByName(clusterName) {\n  return get(`${clusterUrl}/${clusterName}`)\n}\n\nexport function getClusterByProject(projectNames) {\n  return get(`${clusterUrl}/name/${projectNames}`)\n}\n\nexport function checkClusterNameExistence(clusterName) {\n  return get(`${clusterUrl}/existence/${clusterName}`)\n}\n\nexport function listClusters(page, size) {\n  return get(`${clusterUrl}?pageNum=${page}&pageSize=${size}`)\n}\n\nexport function searchClusters(page, size, condition) {\n  return post(`${clusterUrl}/search?pageNum=${page}&pageSize=${size}`, condition)\n}\n\nexport function createCluster(data) {\n  return post(`${clusterUrl}`, data)\n}\n\nexport function healthCheck(clusterName) {\n  return get(`${clusterUrl}/health/${clusterName}`)\n}\n\nexport function clusterRecover(clusterName) {\n  return post(`${clusterUrl}/recover/${clusterName}`, {})\n}\n\nexport function deleteCluster(clusterName, force) {\n  return del(`${clusterUrl}/${clusterName}?force=${force}`)\n}\n\nexport function importCluster(data) {\n  return post(`${clusterUrl}/import/`, data)\n}\n\nexport function allClusters() {\n  return get(`${clusterUrl}`)\n}\n\nexport function initCluster(clusterName) {\n  return post(`${clusterUrl}/init/${clusterName}/`, {})\n}\n\nexport function upgradeCluster(clusterName, version) {\n  let req = {\n    clusterName: clusterName,\n    version: version,\n  }\n  return post(`${clusterUrl}/upgrade/`, req)\n}\n\nexport function getClusterStatus(clusterName) {\n  return get(`${clusterUrl}/status/${clusterName}`)\n}\n\nexport function getClusterLog(clusterName) {\n  return get(clusterLoggerUrl.replace(\"{cluster_name}\", clusterName))\n}\n\nexport function getClusterNodeLog(clusterName, nodeName) {\n  return get(clusterNodeLoggerUrl.replace(\"{cluster_name}\", clusterName).replace(\"{node_name}\", nodeName))\n}\n\nexport function getProvisionerLog(clusterName, logId) {\n  return get(storageProvisionerLoggerUrl.replace(\"{cluster_name}\", clusterName).replace(\"{log_id}\", logId))\n}\n\nexport function openLogger(clusterName) {\n  window.open(`/ui/#/logger?clusterName=${clusterName}`, \"_blank\", \"height=865, width=800, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=yes,location=no, status=no\")\n}\n\nexport function openProvisionerLogger(clusterName, logId) {\n  window.open(`/ui/#/logger?clusterName=${clusterName}&logId=${logId}`, \"_blank\", \"height=865, width=800, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=yes,location=no, status=no\")\n}\n\nexport function getSecret(clusterName) {\n  return get(`${clusterUrl}/secret/${clusterName}`)\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('layout-content',{attrs:{\"header\":_vm.$t('commons.button.import'),\"back-to\":{ name: 'ClusterList' }}},[_c('el-row',[_c('el-col',{attrs:{\"span\":4}},[_c('br')]),_c('el-col',{attrs:{\"span\":10}},[_c('div',{staticClass:\"grid-content bg-purple-light\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"label-position\":\"left\",\"rules\":_vm.rules,\"label-width\":\"120px\"}},[_c('el-form-item',{attrs:{\"label\":_vm.$t('commons.table.name'),\"prop\":\"name\"}},[_c('el-input',{staticStyle:{\"width\":\"100%\"},attrs:{\"clearable\":\"\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":_vm.$t('project.project'),\"prop\":\"projectName\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"filterable\":\"\",\"clearable\":\"\"},model:{value:(_vm.form.projectName),callback:function ($$v) {_vm.$set(_vm.form, \"projectName\", _vm._n($$v))},expression:\"form.projectName\"}},_vm._l((_vm.projects),function(item){return _c('el-option',{key:item.name,attrs:{\"value\":item.name}},[_vm._v(_vm._s(item.name))])}),1)],1),_c('el-form-item',{attrs:{\"label\":\"apiServer\",\"prop\":\"apiServer\"}},[_c('el-input',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":_vm.$t('cluster.import.api_server_help'),\"clearable\":\"\"},model:{value:(_vm.form.apiServer),callback:function ($$v) {_vm.$set(_vm.form, \"apiServer\", $$v)},expression:\"form.apiServer\"}})],1),_c('el-form-item',{attrs:{\"label\":\"router\",\"prop\":\"router\"}},[_c('el-input',{staticStyle:{\"width\":\"100%\"},attrs:{\"placeholder\":_vm.$t('cluster.import.router_help'),\"clearable\":\"\"},model:{value:(_vm.form.router),callback:function ($$v) {_vm.$set(_vm.form, \"router\", $$v)},expression:\"form.router\"}})],1),_c('el-form-item',{attrs:{\"label\":\"token\",\"prop\":\"token\"}},[_c('el-input',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"textarea\",\"autosize\":{ minRows: 2},\"clearable\":\"\"},model:{value:(_vm.form.token),callback:function ($$v) {_vm.$set(_vm.form, \"token\", $$v)},expression:\"form.token\"}})],1),_c('el-form-item',{staticStyle:{\"float\":\"right\"}},[_c('el-button',{on:{\"click\":function($event){return _vm.onCancel()}}},[_vm._v(_vm._s(_vm.$t(\"commons.button.cancel\")))]),_c('el-button',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loadding),expression:\"loadding\"}],attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(_vm._s(_vm.$t(\"commons.button.create\")))])],1)],1)],1)])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <layout-content :header=\"$t('commons.button.import')\" :back-to=\"{ name: 'ClusterList' }\">\n    <el-row>\n      <el-col :span=\"4\"><br /></el-col>\n      <el-col :span=\"10\">\n        <div class=\"grid-content bg-purple-light\">\n          <el-form :model=\"form\" ref=\"form\" label-position='left' :rules=\"rules\" label-width=\"120px\">\n            <el-form-item :label=\"$t('commons.table.name')\" prop=\"name\">\n              <el-input style=\"width: 100%\" v-model=\"form.name\" clearable></el-input>\n            </el-form-item>\n            <el-form-item :label=\"$t('project.project')\" prop=\"projectName\">\n              <el-select filterable style=\"width: 100%\" v-model.number=\"form.projectName\" clearable>\n                <el-option v-for=\"item of projects\" :key=\"item.name\" :value=\"item.name\">{{ item.name }}</el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item label=\"apiServer\" prop=\"apiServer\">\n              <el-input style=\"width: 100%\" v-model=\"form.apiServer\" :placeholder=\"$t('cluster.import.api_server_help')\" clearable></el-input>\n            </el-form-item>\n            <el-form-item label=\"router\" prop=\"router\">\n              <el-input style=\"width: 100%\" v-model=\"form.router\" :placeholder=\"$t('cluster.import.router_help')\" clearable></el-input>\n            </el-form-item>\n            <el-form-item label=\"token\" prop=\"token\">\n              <el-input type=\"textarea\" :autosize=\"{ minRows: 2}\" style=\"width: 100%\" v-model=\"form.token\" clearable></el-input>\n            </el-form-item>\n            <el-form-item style=\"float: right\">\n              <el-button @click=\"onCancel()\">{{ $t(\"commons.button.cancel\") }}</el-button>\n              <el-button type=\"primary\" v-loading=\"loadding\" @click=\"onSubmit\">{{ $t(\"commons.button.create\") }}</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </el-col>\n    </el-row>\n  </layout-content>\n</template>\n\n<script>\nimport LayoutContent from \"@/components/layout/LayoutContent\"\nimport { allProjects } from \"@/api/projects\"\nimport { importCluster } from \"@/api/cluster\"\nimport Rule from \"@/utils/rules\"\n\nexport default {\n  name: \"ClusterImport\",\n  components: { LayoutContent },\n  data() {\n    return {\n      loadding: false,\n      projects: [],\n      form: {\n        name: \"\",\n        apiServer: \"\",\n        token: \"\",\n        router: \"\",\n        projectName: \"kubeoperator\",\n      },\n      rules: {\n        name: [Rule.RequiredRule],\n        apiServer: [Rule.RequiredRule],\n        token: [Rule.RequiredRule],\n        projectName: [Rule.RequiredRule],\n        router: [Rule.RequiredRule],\n      },\n    }\n  },\n  methods: {\n    onSubmit() {\n      this.$refs[\"form\"].validate((valid) => {\n        if (valid) {\n          this.loadding = true\n          importCluster(this.form)\n            .then(() => {\n              this.loadding = false\n              this.$router.push({ name: \"ClusterList\" })\n            })\n            .catch(() => {\n              this.loadding = false\n            })\n        } else {\n          return false\n        }\n      })\n    },\n    getProjects() {\n      allProjects().then((data) => {\n        this.projects = data.items\n      })\n    },\n    onCancel() {\n      this.$router.push({ name: \"ClusterList\" })\n    },\n  },\n  created() {\n    this.getProjects()\n  },\n}\n</script>\n\n<style scoped>\n</style>\n","import mod from \"-!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=5e41dbcd&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5e41dbcd\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}