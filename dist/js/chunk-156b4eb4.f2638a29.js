(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-156b4eb4"],{"046b":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("complex-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{header:e.$t("message.message"),selects:e.selects,fit:!0,"default-sort":{prop:"create_time",order:"descending"},data:e.data,columns:e.columns,"pagination-config":e.paginationConfig,"search-config":e.searchConfig},on:{"update:selects":function(t){e.selects=t},search:e.search},scopedSlots:e._u([{key:"header",fn:function(){return[s("el-button-group",[s("el-button",{attrs:{size:"small",disabled:e.selects.length<1},on:{click:function(t){return e.markAsRead()}}},[e._v(" "+e._s(e.$t("message.mark_as_read"))+" ")]),s("el-button",{attrs:{size:"small",disabled:e.selects.length<1},on:{click:function(t){return e.del()}}},[e._v(" "+e._s(e.$t("commons.button.delete"))+" ")])],1)]},proxy:!0}])},[s("el-table-column",{attrs:{type:"selection",fix:""}}),s("el-table-column",{attrs:{label:e.$t("message.content"),"min-width":"100",fix:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return["READ"===a.readStatus?s("svg",{staticClass:"icon svg-icon",style:{color:"#969696"},attrs:{"aria-hidden":"true",size:"5x"}},[s("use",{attrs:{"xlink:href":"#iconyidu1"}})]):e._e(),"UNREAD"===a.readStatus?s("svg",{staticClass:"icon svg-icon",style:{color:"#0079b8"},attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#iconweidu1"}})]):e._e(),s("span",{staticClass:"message-link",style:{color:"UNREAD"===a.readStatus?"#0079b8":"#969696"},on:{click:function(t){return e.onDetail(a)}}},[e._v(" "+e._s(e.$t("message.title."+a.message.title)))])]}}])}),s("el-table-column",{attrs:{label:e.$t("message.type"),"min-width":"100",prop:"message.type",fix:""}}),s("el-table-column",{attrs:{label:e.$t("message.level"),"min-width":"100",prop:"message.level"}}),s("el-table-column",{attrs:{label:e.$t("commons.table.status"),"min-width":"100",prop:"readStatus"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return["READ"===a.readStatus?s("svg",{staticClass:"icon svg-icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#iconyidu3"}})]):e._e(),"UNREAD"===a.readStatus?s("svg",{staticClass:"icon svg-icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#iconinform-weidu"}})]):e._e(),e._v(" "+e._s(e.$t("message."+a.readStatus))+" ")]}}])}),s("el-table-column",{attrs:{sortable:"","sort-by":"createdAt",label:e.$t("commons.table.create_time")},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(" "+e._s(e._f("datetimeFormat")(s.createdAt))+" ")]}}])}),s("fu-table-operations",{attrs:{buttons:e.buttons,label:e.$t("commons.table.action"),fix:""}})],1),s("el-dialog",{attrs:{title:e.$t("message.detail.message_detail"),visible:e.dialogVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("span",[e._v(e._s(e.$t("message.detail.basicInformation")))]),s("el-divider"),"cluster_event_warning"===e.detail.message.title?s("div",[s("p",[e._v(e._s(e.$t("message.detail.clusterName"))+": "+e._s(e.detail.clusterName)+" ")]),s("p",[e._v(e._s(e.$t("message.detail.host"))+": "+e._s(e.detail.msgContent["host"]))]),s("p",[e._v(e._s(e.$t("message.detail.name"))+": "+e._s(e.detail.msgContent["name"]))]),s("p",[e._v(e._s(e.$t("message.detail.type"))+": "+e._s(e.detail.msgContent["type"]))]),s("p",[e._v(e._s(e.$t("message.detail.component"))+": "+e._s(e.detail.msgContent["component"]))]),s("p",[e._v(e._s(e.$t("message.detail.detail"))+": "+e._s(e.detail.msgContent["message"]))]),s("p",[e._v(e._s(e.$t("message.detail.kind"))+": "+e._s(e.detail.msgContent["kind"]))]),s("p",[e._v(e._s(e.$t("message.detail.cause"))+": "+e._s(e.detail.msgContent["reason"]))]),s("p",[e._v(e._s(e.$t("message.detail.time"))+": "+e._s(e._f("datetimeFormat")(e.detail.msgContent["createdAt"])))])]):e._e(),"cluster_event_warning"!==e.detail.message.title?s("div",[s("p",[e._v(e._s(e.$t("message.detail.clusterName"))+": "+e._s(e.detail.clusterName)+" ")]),s("p",[e._v(e._s(e.$t("message.detail.detail"))+": "+e._s(e.detail.msgContent["message"]))]),s("p",[e._v(e._s(e.$t("message.detail.time"))+": "+e._s(e._f("datetimeFormat")(e.detail["createdAt"])))])]):e._e(),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("commons.button.ok")))])],1)],1)],1)},n=[],i=s("30d5"),o=(s("b1fa"),s("2e6f"),s("af21"),s("2769"),s("ecf1"),s("a5c9"),s("86ca")),l=s("746e"),c={name:"MessageCenter",components:{ComplexTable:o["a"]},data:function(){var e=this;return{paginationConfig:{currentPage:1,pageSize:10,total:0},selects:[],loading:!1,data:[],buttons:[{label:this.$t("commons.button.delete"),icon:"el-icon-delete",click:function(t){e.del(t.id)}}],columns:[],dialogVisible:!1,searchConfig:{quickPlaceholder:this.$t("commons.search.quickSearch"),components:[{field:"type",label:this.$t("message.type"),component:"FuComplexInput",defaultOperator:"eq"},{field:"level",label:this.$t("message.level"),component:"FuComplexSelect",options:[{label:"Warning",value:"Warning"},{label:"Info",value:"Info"}],multiple:!0},{field:"table.status",label:this.$t("commons.table.status"),component:"FuComplexSelect",options:[{label:this.$t("message.READ"),value:"READ"},{label:this.$t("message.UNREAD"),value:"UNREAD"}],multiple:!0},{field:"created_at",label:this.$t("commons.table.create_time"),component:"FuComplexDateTime",valueFormat:"yyyy-MM-dd HH:mm:ss"}]},detail:{message:{},readStatus:"",msgContent:{},clusterName:""}}},methods:{handleSelectionChange:function(e){this.selects=e},markAsRead:function(){var e,t=this,s=[],a=[],n=Object(i["a"])(this.selects);try{for(n.s();!(e=n.n()).done;){var o=e.value;a.push(o),s.push(Object(l["g"])({items:a,operation:"update"}))}}catch(c){n.e(c)}finally{n.f()}Promise.all(s).then((function(){t.search(),t.$message({type:"success",message:t.$t("commons.msg.op_success")})}))},del:function(e){var t=this;this.$confirm(this.$t("commons.confirm_message.delete"),this.$t("commons.message_box.prompt"),{confirmButtonText:this.$t("commons.button.confirm"),cancelButtonText:this.$t("commons.button.cancel"),type:"warning"}).then((function(){if(e)Object(l["a"])(e).then((function(){t.search(),t.$message({type:"success",message:"".concat(t.$t("message.message"),"+").concat(t.$t("commons.msg.delete_success"),"!")})}));else{var s,a=[],n=Object(i["a"])(t.selects);try{for(n.s();!(s=n.n()).done;){var o=s.value;a.push(Object(l["a"])(o.id))}}catch(c){n.e(c)}finally{n.f()}Promise.all(a).then((function(){t.search(),t.$message({type:"success",message:t.$t("commons.msg.delete_success")})}))}}))},search:function(e){var t=this;this.loading=!0;var s=this.paginationConfig,a=s.currentPage,n=s.pageSize;Object(l["d"])(a,n,e).then((function(e){t.loading=!1,t.data=e.items,console.log(123,e),t.paginationConfig.total=e.total}))},onDetail:function(e){if("UNREAD"===e.readStatus){e.readStatus="READ";var t=[];t.push(e),Object(l["g"])({items:t,operation:"update"})}this.detail=e,this.dialogVisible=!0},handleClose:function(e){e()}},created:function(){this.search()}},r=c,u=(s("b2c5"),s("5d22")),m=Object(u["a"])(r,a,n,!1,null,"29ff4fee",null);t["default"]=m.exports},"746e":function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return l})),s.d(t,"e",(function(){return c})),s.d(t,"f",(function(){return r})),s.d(t,"g",(function(){return u})),s.d(t,"d",(function(){return m}));s("a5c9");var a=s("ff66"),n="/api/v1/message";function i(e){return Object(a["b"])("".concat(n,"/").concat(e))}function o(){return Object(a["c"])("".concat(n,"/receiver"))}function l(){return Object(a["c"])("".concat(n,"/subscribe"))}function c(e){return Object(a["e"])("".concat(n,"/subscribe"),e)}function r(e){return Object(a["e"])("".concat(n,"/receiver"),e)}function u(e){return Object(a["e"])("".concat(n,"/mail/batch"),e)}function m(e,t,s){return Object(a["e"])("".concat(n,"/search?pageNum=").concat(e,"&pageSize=").concat(t),s)}},a9ae:function(e,t,s){},b2c5:function(e,t,s){"use strict";s("a9ae")}}]);
//# sourceMappingURL=chunk-156b4eb4.f2638a29.js.map