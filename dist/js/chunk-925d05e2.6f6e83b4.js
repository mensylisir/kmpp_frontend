(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-925d05e2"],{"0cce":function(t,e,n){"use strict";n("ef6c")},"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"1a55":function(t,e,n){"use strict";n("648b")},"648b":function(t,e,n){t.exports={theme:"#5354bb"}},"841c":function(t,e,n){"use strict";var a=n("d784"),i=n("825a"),o=n("1d80"),s=n("129f"),r=n("577e"),c=n("14c3");a("search",(function(t,e,n){return[function(e){var n=o(this),a=void 0==e?void 0:e[t];return void 0!==a?a.call(e,n):new RegExp(e)[t](r(n))},function(t){var a=i(this),o=r(t),l=n(e,a,o);if(l.done)return l.value;var u=a.lastIndex;s(u,0)||(a.lastIndex=0);var f=c(a,o);return s(a.lastIndex,u)||(a.lastIndex=u),null===f?-1:f.index}]}))},"86ca":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"complex-table"},[t.$slots.header||t.header?n("div",{staticClass:"complex-table__header"},[t._t("header",(function(){return[t._v(t._s(t.header))]})),t.$slots.toolbar||t.searchConfig?n("div",{staticClass:"complex-table__toolbar"},[n("div",[t._t("toolbar")],2),n("fu-search-bar",t._b({on:{exec:t.search},scopedSlots:t._u([{key:"complex",fn:function(){return[t._t("complex")]},proxy:!0}],null,!0)},"fu-search-bar",t.searchConfig,!1),[t._t("buttons"),n("fu-table-column-select",{attrs:{columns:t.columns}})],2)],1):t._e()],2):t._e(),n("div",{staticClass:"complex-table__body"},[n("fu-table",t._g(t._b({attrs:{columns:t.columns,"local-key":t.localKey},on:{"selection-change":t.handleSelectionChange}},"fu-table",t.$attrs,!1),t.$listeners),[t._t("default")],2)],1),t.$slots.pagination||t.paginationConfig?n("div",{staticClass:"complex-table__pagination"},[t._t("pagination",(function(){return[n("fu-table-pagination",t._b({attrs:{"current-page":t.paginationConfig.currentPage,"page-size":t.paginationConfig.pageSize},on:{"update:currentPage":function(e){return t.$set(t.paginationConfig,"currentPage",e)},"update:current-page":function(e){return t.$set(t.paginationConfig,"currentPage",e)},"update:pageSize":function(e){return t.$set(t.paginationConfig,"pageSize",e)},"update:page-size":function(e){return t.$set(t.paginationConfig,"pageSize",e)},change:t.search}},"fu-table-pagination",t.paginationConfig,!1))]}))],2):t._e()])},i=[],o={name:"ComplexTable",props:{columns:{type:Array,default:function(){return[]}},localKey:String,header:String,searchConfig:Object,paginationConfig:Object,selects:Array},data:function(){return{condition:{}}},methods:{search:function(t,e){t&&(this.condition=t),this.$emit("search",this.condition,e)},handleSelectionChange:function(t){this.$emit("update:selects",t)}}},s=o,r=(n("1a55"),n("2877")),c=Object(r["a"])(s,a,i,!1,null,null,null);e["a"]=c.exports},"992c":function(t,e,n){t.exports={theme:"#5354bb"}},a026:function(t,e,n){"use strict";n("992c")},a6c5:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return r}));n("99af");var a=n("ff66"),i="/api/v1/certificates";function o(t,e,n){return Object(a["e"])("".concat(i,"/search?pageNum=").concat(t,"&pageSize=").concat(e),n)}function s(t){return Object(a["e"])("".concat(i),t)}function r(t){return Object(a["e"])("".concat(i,"/upload"),t)}},b21e:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("caad"),n("2532");var a=n("4360"),i=function(t){var e=a["a"].getters&&a["a"].getters.roles;return e.some((function(e){return t.includes(e)}))}},b85c:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");var a=n("06c5");function i(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Object(a["a"])(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){c=!0,s=t},f:function(){try{r||null==n["return"]||n["return"]()}finally{if(c)throw s}}}}},be17:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content-container"},[t.$slots.description||t.description?n("div",{staticClass:"content-container__description"},[n("el-alert",{attrs:{title:t.description,type:"info"}}),n("br")],1):t._e(),t.$slots.header||t.header?n("div",{staticClass:"content-container__header"},[t._t("header",(function(){return[t.showBack?n("back-button",{attrs:{path:t.backPath,name:t.backName,to:t.backTo}}):t._e(),t._v(" "+t._s(t.header)+" ")]}))],2):t._e(),t.$slots.toolbar?n("div",{staticClass:"content-container__toolbar"},[t._t("toolbar")],2):t._e(),t._t("default")],2)},i=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-icon",{staticClass:"back-button",attrs:{name:"back"},nativeOn:{click:function(e){return t.jump.apply(null,arguments)}}})},s=[],r=(n("b0c0"),{name:"BackButton",props:{path:String,name:String,to:Object},methods:{jump:function(){var t=this.path,e=this.name,n=this.to;t&&this.$router.push(t),e&&this.$router.push(e),n&&this.$router.push(n)}}}),c=r,l=(n("eb9f"),n("2877")),u=Object(l["a"])(c,o,s,!1,null,null,null),f=u.exports,p={name:"LayoutContent",components:{BackButton:f},props:{header:String,description:String,backPath:String,backName:String,backTo:Object},computed:{showBack:function(t){var e=t.backPath,n=t.backName,a=t.backTo;return e||n||a}}},d=p,m=(n("a026"),Object(l["a"])(d,a,i,!1,null,null,null));e["a"]=m.exports},c43c:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n("99af");var a=n("ff66"),i="/api/v1/settings";function o(){return Object(a["c"])("".concat(i,"/registry"))}},eb9f:function(t,e,n){"use strict";n("f574")},ef6c:function(t,e,n){},f052:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("layout-content",{attrs:{header:"证书"}},[n("complex-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.data,"local-key":"host_columns","pagination-config":t.paginationConfig,selects:t.hostSelections,"search-config":t.searchConfig},on:{search:t.search,"update:selects":function(e){t.hostSelections=e}},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ADMIN"],expression:"['ADMIN']"}],attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.create()}}},[t._v(t._s(t.$t("commons.button.create")))]),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["ADMIN"],expression:"['ADMIN']"}],attrs:{size:"small",type:"primary",icon:"el-icon-upload2"},on:{click:function(e){return t.add()}}},[t._v("导入")])],1)]},proxy:!0}])},[n("el-table-column",{attrs:{type:"selection",fix:""}}),n("el-table-column",{attrs:{label:t.$t("commons.table.name"),"show-overflow-tooltip":"","min-width":"120",fix:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",[t._v(t._s(a.name))])]}}])}),n("el-table-column",{attrs:{label:t.$t("commons.table.type"),"min-width":"100",prop:"type",fix:""},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",[t._v(t._s("true"===a.is_ca?"根证书":"普通证书"))])]}}])}),n("el-table-column",{attrs:{label:"创建时间",width:"180px"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(" "+t._s(t._f("datetimeFormat")(n.createdAt))+" ")]}}])})],1),n("el-dialog",{staticClass:"import",attrs:{title:"导入",width:"66.7%",visible:t.dialogImportVisible},on:{"update:visible":function(e){t.dialogImportVisible=e}}},[n("el-form",[n("el-form-item",{staticClass:"item"},[n("div",{staticStyle:{width:"50%"}},[n("div",{staticClass:"title"},[t._v("上传公钥文件")]),n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-upload",{ref:"my-upload",staticClass:"upload-demo",attrs:{"on-change":t.onUploadChange,action:"","auto-upload":!1,drag:"",limit:1,"on-remove":t.removeFile}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[n("div",{staticClass:"subtitle"},[t._v("点击或将文件拖拽到这里上传")]),n("div",{staticClass:"tip"},[t._v(" "+t._s(t.$t("cluster.detail.backup.local_recover_tips"))+" ")])])])],1)],1),n("div",{staticStyle:{width:"50%","margin-left":"20px"}},[n("div",{staticClass:"title"},[t._v("上传私钥文件")]),n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-upload",{ref:"my-upload",staticClass:"upload-demo",attrs:{"on-change":t.onPrivateUpload,action:"","auto-upload":!1,drag:"",limit:1,"on-remove":t.removeFile1}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[n("div",{staticClass:"subtitle"},[t._v("点击或将文件拖拽到这里上传")]),n("div",{staticClass:"tip"},[t._v(" "+t._s(t.$t("cluster.detail.backup.local_recover_tips"))+" ")])])])],1)],1)])],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogImportVisible=!1}}},[t._v(t._s(t.$t("commons.button.cancel")))]),n("el-button",{attrs:{type:"primary",disabled:!(t.privateFile.name&&t.file.name)},on:{click:function(e){return t.onUploadFile()}}},[t._v(t._s(t.$t("commons.button.ok")))])],1)],1)],1)},i=[],o=n("b85c"),s=n("2909"),r=(n("b0c0"),n("ac1f"),n("841c"),n("be17")),c=n("a6c5"),l=n("86ca"),u=n("c43c"),f=n("b21e"),p={name:"HostList",components:{ComplexTable:l["a"],LayoutContent:r["a"]},data:function(){var t=this;return{buttons:[{label:this.$t("commons.button.delete"),icon:"el-icon-delete",click:function(e){t.onDelete(e.name)},disabled:function(t){return"Running"!==t.status&&"Failed"!==t.status}}],paginationConfig:{currentPage:1,pageSize:10,total:0},data:[],dialogErrorVisible:!1,dialogDetailVisible:!1,errMsg:"",currentHost:{},hostSelections:[],syncHostList:[],dialogSyncVisible:!1,dialogImportVisible:!1,isUploadDisable:!0,file:{},privateFile:{},searchConfig:{quickPlaceholder:this.$t("commons.search.quickSearch"),components:[{field:"name",label:this.$t("commons.table.name"),component:"FuComplexInput",defaultOperator:"eq"},{field:"ip",label:this.$t("host.ip"),component:"FuComplexInput",defaultOperator:"eq"},{field:"created_at",label:this.$t("commons.table.create_time"),component:"FuComplexDateTime",valueFormat:"yyyy-MM-dd"}]},loading:!1,isAdmin:Object(f["a"])("ADMIN"),timer:{},cluster:""}},methods:{create:function(){var t=this;Object(u["a"])().then((function(){t.$router.push({name:"certificationCreate"})}))},add:function(){this.dialogImportVisible=!0},sync:function(){this.dialogSyncVisible=!0},submitSync:function(){},onUploadChange:function(t){this.file=t},onPrivateUpload:function(t){this.privateFile=t},removeFile:function(){this.file={}},removeFile1:function(){this.privateFile={}},onImport:function(){var t=this;Object(u["a"])().then((function(){t.dialogImportVisible=!0,t.isUploadDisable=!0,t.$refs["my-upload"]&&t.$refs["my-upload"].clearFiles()}))},download:function(){window.open("/api/v1/hosts/template")},getErrorInfo:function(t){this.dialogErrorVisible=!0,this.errMsg=t.message},getDetailInfo:function(t){this.dialogDetailVisible=!0,this.currentHost=t},onUploadFile:function(){var t=this,e=["pem","key","crt"],n=this.file.name.lastIndexOf(".");if(-1!==n){var a=this.file.name.substring(n+1,this.file.name.length).toLowerCase();if(e.indexOf(a)<0)this.$message({type:"error",message:this.$t("host.not_support_format")});else{var i=this.privateFile.name.lastIndexOf(".");if(-1!==i){var o=this.privateFile.name.substring(i+1,this.privateFile.name.length).toLowerCase();if(e.indexOf(o)<0)this.$message({type:"error",message:this.$t("host.not_support_format")});else{var s=new FormData;s.append("cert",this.file.raw),s.append("key",this.privateFile.raw),Object(c["c"])(s).then((function(){t.$message({type:"success",message:t.$t("commons.msg.import_success")}),t.search(),t.dialogImportVisible=!1}),(function(){t.search(),t.dialogImportVisible=!1}))}}else this.$message({type:"error",message:this.$t("host.not_support_format")})}}else this.$message({type:"error",message:this.$t("host.not_support_format")})},onDelete:function(){},onGrant:function(){this.$router.push({name:"ProjectAuthorizationList"})},search:function(t){var e=this;this.loading=!0;var n=this.paginationConfig,a=n.currentPage,i=n.pageSize;Object(c["b"])(a,i,t).then((function(t){e.loading=!1,e.data=Object(s["a"])(t.items),e.paginationConfig.total=t.total})).catch((function(){e.loading=!1}))},polling:function(){var t=this;this.timer=setInterval((function(){var e,n=!1,a=["Initializing","Terminating","Synchronizing","Waiting","Creating"],i=Object(o["a"])(t.data);try{for(i.s();!(e=i.n()).done;){var s=e.value;if(-1!==a.indexOf(s.status)){n=!0;break}}}catch(f){i.e(f)}finally{i.f()}if(n){var r=t.paginationConfig,l=r.currentPage,u=r.pageSize;Object(c["b"])(l,u).then((function(e){t.data=e.items,t.paginationConfig.total=e.total}))}}),1e4)}},mounted:function(){this.search(),this.polling()},beforeDestroy:function(){clearInterval(this.timer)}},d=p,m=(n("0cce"),n("2877")),h=Object(m["a"])(d,a,i,!1,null,"75b0e332",null);e["default"]=h.exports},f574:function(t,e,n){t.exports={theme:"#5354bb"}}}]);
//# sourceMappingURL=chunk-925d05e2.6f6e83b4.js.map